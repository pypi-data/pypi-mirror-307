(function(Z,ie){typeof exports=="object"&&typeof module<"u"?ie(exports):typeof define=="function"&&define.amd?define(["exports"],ie):(Z=typeof globalThis<"u"?globalThis:Z||self,ie(Z.trame_rca={}))})(this,function(Z){"use strict";class ie{constructor(t){this.vueComponent=t,this.img=new Image,this.url="",this.blob=null,this.img.addEventListener("load",()=>{this.vueComponent.displayURL=this.url,this.vueComponent.hasContent=!0})}update(t,r){window.URL.revokeObjectURL(this.url),this.blob=new Blob([r],{type:t}),this.url=URL.createObjectURL(this.blob),this.img.src=this.url}}const Qe={props:{name:{type:String,default:"default"},origin:{type:String,default:"anonymous"},poolSize:{type:Number,default:4}},watch:{poolSize(){this.updatePoolSize()}},data(){return{hasContent:!1,displayURL:""}},expose:["resetContent","updatePoolSize"],methods:{resetContent(){this.hasContent=!1},updatePoolSize(){for(;this.frames.length<this.poolSize;)this.frames.push(new ie(this));for(;this.frames.length>this.poolSize;)this.frames.pop()},cleanup(){this.wslinkSubscription&&this.trame&&(this.trame.client.getConnection().getSession().unsubscribe(this.wslinkSubscription),this.wslinkSubscription=null)}},created(){this.frames=[],this.nextFrameIndex=0,this.updatePoolSize(),this.wslinkSubscription=null,this.onImage=([{name:e,meta:t,content:r}])=>{const n=["image/apng","image/avif","image/gif","image/jpeg","image/png","image/svg+xml","image/webp"];this.name===e&&(n.includes(t.type)?(this.nextFrameIndex=(this.nextFrameIndex+1)%this.frames.length,this.frames[this.nextFrameIndex].update(t.type,r)):this.hasContent=!1)},this.trame&&(this.wslinkSubscription=this.trame.client.getConnection().getSession().subscribe("trame.rca.topic.stream",this.onImage))},beforeDestroy(){this.cleanup()},beforeUnmount(){this.cleanup()},inject:["trame"],template:'<img :src="displayURL" v-show="hasContent" />'};class vn{constructor(t,r="video/webm; codecs=vp09.00.10.08"){this.videoElement=t,this.mime=r,this.sourceBuffer=null,this.mediaSource=null,this.initSegment=null,this.mediaSegments=[],this.loaded=0,"MediaSource"in window?(this.mediaSource=new MediaSource,this.videoElement.src=URL.createObjectURL(this.mediaSource),this.mediaSource.addEventListener("sourceopen",()=>{MediaSource.isTypeSupported(this.mime)?this.initSourceBuffer():console.error(`Unsupported MIME type or codec: ${this.mime}`)})):console.error("The Media Source Extensions API is not supported.")}initSourceBuffer(){this.sourceBuffer=this.mediaSource.addSourceBuffer(this.mime),this.sourceBuffer.mode="sequence",this.initSegment?this.sourceBuffer.appendBuffer(this.initSegment):console.error("Need initialization segment"),this.sourceBuffer.onupdateend=()=>{if(this.mediaSegments.length)this.sourceBuffer.updating===!1&&(this.sourceBuffer.appendBuffer(this.mediaSegments.shift()),this.loaded+=1);else return}}queueChunk(t){this.mediaSource.readyState==="open"&&this.sourceBuffer&&this.sourceBuffer.updating===!1?(this.sourceBuffer.appendBuffer(t),this.loaded+=1):this.mediaSegments.push(t)}exit(){this.sourceBuffer.abort(),this.mediaSource.endOfStream(),this.videoElement.play(),URL.revokeObjectURL(this.videoElement.src)}}const Ie={props:{name:{type:String,default:"default"},origin:{type:String,default:"anonymous"}},data(){return{hasContent:!1,loaded:0,received:0}},expose:["requestInitializationSegment"],methods:{requestInitializationSegment(){this.rcaPushSize&&this.rcaPushSize({videoHeader:1})},cleanup(){this.wslinkSubscription&&this.trame&&(this.trame.client.getConnection().getSession().unsubscribe(this.wslinkSubscription),this.wslinkSubscription=null,this.decoder.exit())}},created(){this.pushChunk=(e,t)=>{Array.from(new Uint8Array(e).slice(0,4)).map(n=>n.toString(16)).join("")=="1a45dfa3"&&t.includes("webm")?(console.log("detected ebml fourcc"),this.decoder&&this.decoder.exit(),this.decoder=new vn(this.$el),this.decoder.initSegment=new Uint8Array(e)):this.decoder.mime!==t?(console.log("detected mime change"),this.requestInitializationSegment()):(this.decoder.queueChunk(e),this.loaded=this.decoder.loaded,this.hasContent=!0)}},mounted(){this.onChunkAvailable=async([{name:e,meta:t,content:r}])=>{if(!t.type.includes("video/")){this.hasContent=!1;return}if(this.name===e){this.received+=1;const n=r.buffer?r:new Uint8Array(await r.arrayBuffer());this.pushChunk(n,t.type),this.hasContent=!0}},this.trame&&(this.wslinkSubscription=this.trame.client.getConnection().getSession().subscribe("trame.rca.topic.stream",this.onChunkAvailable),this.requestInitializationSegment())},beforeUnmount(){this.cleanup()},beforeDestroy(){this.cleanup()},inject:["trame","rcaPushSize"],template:`
    <video autoplay="autoplay" muted="muted" v-show="hasContent">
      Your browser does not support the video tag.
    </video>
  `},yn=1,gn=2,dn=3,mn=4,wn=5,Sn=6,En=`

function reportError(e) {
  console.log(e.message);
  postMessage(e.message);
}

function createDecoder(canvas) {
  const ctx = canvas.getContext('2d');
  const ready_frames = [];
  let underflow = true;

  function renderFrame() {
    if (ready_frames.length === 0) {
      underflow = true;
      return;
    }
    const frame = ready_frames.shift();
    underflow = false;
    ctx.drawImage(frame, 0, 0);
    frame.close();
    setTimeout(renderFrame, 0);
  }

  function handleFrame(frame) {
    ready_frames.push(frame);
    if (underflow) {
      underflow = false;
      setTimeout(renderFrame, 0);
    }
  }

  const init = {
    output: handleFrame,
    error: reportError,
  };

  return new VideoDecoder(init);
}

onmessage = async function({ data: msg }) {
  switch(msg.action) {
    case 1: // init
      this.canvas = msg.canvas;
      this.decoder = createDecoder(this.canvas);
      break;
    case 2: // config
      this.canvas.width = msg.config.codedWidth;
      this.canvas.height = msg.config.codedHeight;
      this.decoder.configure(msg.config);
      break;
    case 3: // chunk
      this.decoder.decode(new EncodedVideoChunk({
        timestamp: msg.timestamp,
        type: msg.type,
        data: msg.data,
      }));
      break;
    case 4: // flush
      this.decoder.flush();
      break;
    case 5: // reset
      this.decoder.reset();
      break;
    case 6: // close
      // flush before close() to avoid currepoted state.
      // calling postMessage(flush)
      //         postMessage(close) is not enough since the second
      // abort the first before it finishes.
      await this.decoder.flush();
      this.decoder.close();
      break;
  }
}
`,On=URL.createObjectURL(new Blob([En]));function bn(){const e=new Worker(On);return e.addEventListener("error",()=>console.error("worker failed"),!1),e.onmessage=t=>{console.log(`Worker message: ${t.data}`),console.log(">>> FIXME .....")},e}class xn{constructor(){this.worker=bn(),this.codec="",this.width=0,this.height=0}bindCanvas(t){const r=yn,n=t.transferControlToOffscreen();this.worker.postMessage({action:r,canvas:n},[n])}setContentType(t,r,n){if(this.codec!==t||this.width!==r||this.height!==n){const a=gn;this.codec=t,this.width=r,this.height=n,this.worker.postMessage({action:a,config:{codec:t,codedWidth:r,codedHeight:n}})}}pushChunk(t,r,n){const a=dn;this.worker.postMessage({action:a,timestamp:t,type:r,data:n},[n.buffer])}flush(){this.worker.postMessage({action:mn})}reset(){this.worker.postMessage({action:wn})}terminate(){this.worker.postMessage({action:Sn})}}const et={props:{name:{type:String,default:"default"},origin:{type:String,default:"anonymous"}},data(){return{isSupported:"VideoFrame"in window}},expose:[""],methods:{cleanup(){this.worker&&this.worker.terminate(),this.wslinkSubscription&&this.trame&&(this.trame.client.getConnection().getSession().unsubscribe(this.wslinkSubscription),this.wslinkSubscription=null)}},mounted(){if(this.worker=new xn,this.isSupported){const e=this.$el.querySelector(".js-canvas");this.worker.bindCanvas(e),this.onChunkAvailable=async([{name:t,meta:r,content:n}])=>{if(!(!r.type.includes("application/octet-stream")||!r.codec.length||r.codec.includes("unknown"))&&this.name===t&&r.codec.length){this.worker.setContentType(r.codec,r.w,r.h);const a=n.buffer?n:new Uint8Array(await n.arrayBuffer());this.worker.pushChunk(r.st,r.key,a)}},this.trame&&(this.wslinkSubscription=this.trame.client.getConnection().getSession().subscribe("trame.rca.topic.stream",this.onChunkAvailable))}},beforeUnmount(){this.cleanup()},beforeDestroy(){this.cleanup()},inject:["trame","rcaPushSize"],template:`
    <div>
      <h1 v-if="!isSupported">WebCodecs API is not supported.</h1>
      <canvas class="js-canvas"></canvas>
    </div>
  `},tt={props:{name:{type:String,default:"default"},origin:{type:String,default:"anonymous"}},data(){return{hasContent:!1}},methods:{cleanup(){this.wslinkSubscription&&this.trame&&(this.trame.client.getConnection().getSession().unsubscribe(this.wslinkSubscription),this.wslinkSubscription=null)}},mounted(){this.wslinkSubscription=null;const e=this.$el,t=e.getContext("2d");this.onImage=async([{name:r,meta:n,content:a}])=>{if(this.name===r)if(n.type.includes("image/rgb24")){const l=a.buffer?a:new Uint8Array(await a.arrayBuffer());e.width=n.w,e.height=n.h;const v=t.createImageData(n.w,n.h),u=v.data;let i=0,s=0;for(;s<u.length;)u[s++]=l[i++],u[s++]=l[i++],u[s++]=l[i++],u[s++]=255;t.putImageData(v,0,0),this.hasContent=!0}else if(n.type.includes("image/rgba32")){const l=new Uint8ClampedArray(a.buffer?a:await a.arrayBuffer());e.width=n.w,e.height=n.h;const v=new ImageData(l,n.w,n.h);t.putImageData(v,0,0),this.hasContent=!0}else this.hasContent=!1},this.trame&&(this.wslinkSubscription=this.trame.client.getConnection().getSession().subscribe("trame.rca.topic.stream",this.onImage))},beforeDestroy(){this.cleanup()},beforeUnmount(){this.cleanup()},inject:["trame"],template:'<canvas class="js-canvas" v-show="hasContent"></canvas>'},Tn={components:{ImageDisplayArea:Qe,MediaSourceDisplayArea:Ie,VideoDecoderDisplayArea:et,RawImageDisplayArea:tt},props:{name:{type:String,default:"default"},origin:{type:String,default:"anonymous"},display:{type:String,default:"image"}},template:`
    <div style="width: 100%; height: 100%;">
      <image-display-area v-if="display === 'image'" :name="name" :origin="origin" :poolSize="4" />
      <media-source-display-area v-if="display === 'media-source'" :name="name" :origin="origin" />
      <video-decoder-display-area v-if="display === 'video-decoder'" :name="name" :origin="origin" />
      <raw-image-display-area v-if="display === 'raw-image'" :name="name" :origin="origin" />
    </div>
  `},kn=["B/s","KB/s","MB/s"];class Rn{constructor(t=255,r=10,n=1e3){this.windowSize=t,this.windowStatSize=r,this.newInteractionThreshold=n,this.lastTS=0,this.serverTime=[],this.clientTimes=[],this.packetSizes=[],this.statWindow=[]}trim(){for(;this.serverTime.length>this.windowSize;)this.serverTime.shift(),this.clientTimes.shift(),this.packetSizes.shift();for(;this.statWindow.length>this.windowStatSize;)this.statWindow.shift()}compute(){if(this.statWindow.length<2)return null;const t=this.statWindow[0],n=(this.statWindow[this.statWindow.length-1]-t)/(this.statWindow.length-1),a=1e3/n,l=[],v=[],u=[0,0];let i=this.clientTimes[0],s=this.serverTime[0],c=0;for(let h=0;h<this.clientTimes.length;h++){const p=this.clientTimes[h]-i,o=this.serverTime[h]-s;c+=this.packetSizes[h],l.push(p),v.push(o),i+=n,s+=n;const f=p<o?p:o,y=p>o?p:o;u[0]>f&&(u[0]=f),u[1]<y&&(u[1]=y)}return c*=a/this.packetSizes.length,{avgFps:a,client:l,server:v,minMax:u,totalSize:c}}addEntry(t,r){const n=Date.now();return this.packetSizes.push(r),this.serverTime.push(t),this.clientTimes.push(n),n-this.lastTS<this.newInteractionThreshold?this.statWindow.push(n):this.statWindow.length=0,this.lastTS=n,this.trim(),this.compute()}}const Mn={props:{name:{type:String,default:"default"},fpsDelta:{type:Number,default:4},statWindowSize:{type:Number,default:10},historyWindowSize:{type:Number,default:255},resetMsThreshold:{type:Number,default:255},wsLinkTopic:{type:String,default:"trame.rca.topic.stream"},packetDecorator:{type:Function,default:({name:e,meta:t,content:r})=>({name:e,serverTime:t.st,contentSize:r.length})}},data(){return{cw:200,ch:200,avg:30,delta:2,totalSize:0}},watch:{statWindowSize(e){this.monitor.windowStatSize=e},historyWindowSize(e){this.monitor.windowSize=e},resetMsThreshold(e){this.monitor.newInteractionThreshold=e}},expose:["sizeUnit"],methods:{sizeUnit(e){let t=e;for(let r=0;r<3;r++){if(t<1e3)return`${t.toFixed(1)} ${kn[r]}`;t/=1e3}},cleanup(){this.observer.unobserve(this.$el),this.wslinkSubscription&&this.trame&&(this.trame.client.getConnection().getSession().unsubscribe(this.wslinkSubscription),this.wslinkSubscription=null)},draw(e,t,r="#1DE9B688",n="#EF9A9A"){if(!this.$el)return;const{cw:a,ch:l}=this,u=this.$el.querySelector(".js-canvas").getContext("2d"),i=Math.floor(l*.5+.5),s=i/(1001*this.fpsDelta),c=a/(e.length-2);u.clearRect(0,0,a,l),u.strokeStyle="black",u.beginPath(),u.moveTo(0,i),u.lineTo(a,i),u.stroke(),u.strokeStyle="#eee";for(let h=0;h<this.fpsDelta;h++)u.beginPath(),u.moveTo(0,i+1e3*(h+1)*s),u.lineTo(a,i+1e3*(h+1)*s),u.stroke(),u.beginPath(),u.moveTo(0,i-1e3*(h+1)*s),u.lineTo(a,i-1e3*(h+1)*s),u.stroke();u.strokeStyle=r,u.lineWidth=8,u.beginPath(),u.moveTo(0,i-s*e[1]);for(let h=2;h<e.length;h++)u.lineTo((h-1)*c,i-s*e[h]);u.stroke(),u.strokeStyle=n,u.lineWidth=2,u.beginPath(),u.moveTo(0,i-s*t[1]);for(let h=2;h<t.length;h++)u.lineTo((h-1)*c,i-s*t[h]);u.stroke()}},created(){this.monitor=new Rn(this.historyWindowSize,this.statWindowSize),this.wslinkSubscription=null,this.onStreamPacket=([e])=>{const{name:t,serverTime:r,contentSize:n}=this.packetDecorator(e);if(this.name===t){const a=this.monitor.addEntry(r,n);a&&(this.avg=a.avgFps,this.totalSize=a.totalSize,this.delta=1e3/(a.minMax[1]-a.minMax[0]),this.draw(a.client,a.server))}},this.trame&&(this.wslinkSubscription=this.trame.client.getConnection().getSession().subscribe(this.wsLinkTopic,this.onStreamPacket)),this.observer=new ResizeObserver(()=>{if(!this.$el)return;const{width:e,height:t}=this.$el.getBoundingClientRect();this.cw=e,this.ch=t})},mounted(){this.observer.observe(this.$el)},beforeDestroy(){this.cleanup()},beforeUnmount(){this.cleanup()},inject:["trame"],template:`
    <v-col style="width: 100%; height: 100%; position: relative;">
      <v-row class="text-subtitle-2" style="position: absolute; top: 0; left: 0; width: 100%; z-index: 1;">
        <v-icon>mdi-gauge</v-icon>
        <v-spacer />
        <div>
          {{ avg.toFixed(1) }} fps
        </div>
        <v-spacer />
        <v-icon>mdi-database-import</v-icon>
        <v-spacer />
        <div>
          {{ sizeUnit(totalSize) }}
        </div>
      </v-row>
      <canvas style="position: absolute; left: 0; top: 0;" class="js-canvas" :width="cw" :height="ch">
      </canvas>
    </v-col>
  `};function De(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dn(e){if(Array.isArray(e))return De(e)}function jn(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nt(e,t){if(e){if(typeof e=="string")return De(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return De(e,t)}}function Cn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function se(e){return Dn(e)||jn(e)||nt(e)||Cn()}function V(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _n(e){if(Array.isArray(e))return e}function Ln(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],a=!0,l=!1,v,u;try{for(r=r.call(e);!(a=(v=r.next()).done)&&(n.push(v.value),!(t&&n.length===t));a=!0);}catch(i){l=!0,u=i}finally{try{!a&&r.return!=null&&r.return()}finally{if(l)throw u}}return n}}function Un(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function je(e,t){return _n(e)||Ln(e,t)||nt(e,t)||Un()}function K(e){"@babel/helpers - typeof";return K=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(e)}function ue(e,t){return ue=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},ue(e,t)}function Fn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ce(e,t,r){return Fn()?ce=Reflect.construct:ce=function(a,l,v){var u=[null];u.push.apply(u,l);var i=Function.bind.apply(a,u),s=new i;return v&&ue(s,v.prototype),s},ce.apply(null,arguments)}var B=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function rt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Bn(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var $n=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,a,l;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(a=n;a--!==0;)if(!e(t[a],r[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(l=Object.keys(t),n=l.length,n!==Object.keys(r).length)return!1;for(a=n;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,l[a]))return!1;for(a=n;a--!==0;){var v=l[a];if(!e(t[v],r[v]))return!1}return!0}return t!==t&&r!==r};const zn=rt($n);var ot=Object.prototype.toString,at=function(t){var r=ot.call(t),n=r==="[object Arguments]";return n||(n=r!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&ot.call(t.callee)==="[object Function]"),n},Ce,it;function Wn(){if(it)return Ce;it=1;var e;if(!Object.keys){var t=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=at,a=Object.prototype.propertyIsEnumerable,l=!a.call({toString:null},"toString"),v=a.call(function(){},"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=function(p){var o=p.constructor;return o&&o.prototype===p},s={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},c=function(){if(typeof window>"u")return!1;for(var p in window)try{if(!s["$"+p]&&t.call(window,p)&&window[p]!==null&&typeof window[p]=="object")try{i(window[p])}catch{return!0}}catch{return!0}return!1}(),h=function(p){if(typeof window>"u"||!c)return i(p);try{return i(p)}catch{return!1}};e=function(o){var f=o!==null&&typeof o=="object",y=r.call(o)==="[object Function]",d=n(o),m=f&&r.call(o)==="[object String]",w=[];if(!f&&!y&&!d)throw new TypeError("Object.keys called on a non-object");var T=v&&y;if(m&&o.length>0&&!t.call(o,0))for(var g=0;g<o.length;++g)w.push(String(g));if(d&&o.length>0)for(var S=0;S<o.length;++S)w.push(String(S));else for(var E in o)!(T&&E==="prototype")&&t.call(o,E)&&w.push(String(E));if(l)for(var O=h(o),b=0;b<u.length;++b)!(O&&u[b]==="constructor")&&t.call(o,u[b])&&w.push(u[b]);return w}}return Ce=e,Ce}var Gn=Array.prototype.slice,Nn=at,st=Object.keys,ye=st?function(t){return st(t)}:Wn(),ut=Object.keys;ye.shim=function(){if(Object.keys){var t=function(){var r=Object.keys(arguments);return r&&r.length===arguments.length}(1,2);t||(Object.keys=function(n){return Nn(n)?ut(Gn.call(n)):ut(n)})}else Object.keys=ye;return Object.keys||ye};var Vn=ye,Kn=Error,qn=EvalError,Pn=RangeError,Xn=ReferenceError,ct=SyntaxError,ft=TypeError,Hn=URIError,Yn=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var a=42;t[r]=a;for(r in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var l=Object.getOwnPropertySymbols(t);if(l.length!==1||l[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var v=Object.getOwnPropertyDescriptor(t,r);if(v.value!==a||v.enumerable!==!0)return!1}return!0},lt=typeof Symbol<"u"&&Symbol,An=Yn,Jn=function(){return typeof lt!="function"||typeof Symbol!="function"||typeof lt("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:An()},_e={__proto__:null,foo:{}},Zn=Object,Qn=function(){return{__proto__:_e}.foo===_e.foo&&!(_e instanceof Zn)},In="Function.prototype.bind called on incompatible ",er=Object.prototype.toString,tr=Math.max,nr="[object Function]",ht=function(t,r){for(var n=[],a=0;a<t.length;a+=1)n[a]=t[a];for(var l=0;l<r.length;l+=1)n[l+t.length]=r[l];return n},rr=function(t,r){for(var n=[],a=r||0,l=0;a<t.length;a+=1,l+=1)n[l]=t[a];return n},or=function(e,t){for(var r="",n=0;n<e.length;n+=1)r+=e[n],n+1<e.length&&(r+=t);return r},ar=function(t){var r=this;if(typeof r!="function"||er.apply(r)!==nr)throw new TypeError(In+r);for(var n=rr(arguments,1),a,l=function(){if(this instanceof a){var c=r.apply(this,ht(n,arguments));return Object(c)===c?c:this}return r.apply(t,ht(n,arguments))},v=tr(0,r.length-n.length),u=[],i=0;i<v;i++)u[i]="$"+i;if(a=Function("binder","return function ("+or(u,",")+"){ return binder.apply(this,arguments); }")(l),r.prototype){var s=function(){};s.prototype=r.prototype,a.prototype=new s,s.prototype=null}return a},ir=ar,pt=Function.prototype.bind||ir,sr=Function.prototype.call,ur=Object.prototype.hasOwnProperty,cr=pt,fr=cr.call(sr,ur),x,lr=Kn,hr=qn,pr=Pn,vr=Xn,Q=ct,I=ft,yr=Hn,vt=Function,Le=function(e){try{return vt('"use strict"; return ('+e+").constructor;")()}catch{}},q=Object.getOwnPropertyDescriptor;if(q)try{q({},"")}catch{q=null}var Ue=function(){throw new I},gr=q?function(){try{return arguments.callee,Ue}catch{try{return q(arguments,"callee").get}catch{return Ue}}}():Ue,ee=Jn(),dr=Qn(),j=Object.getPrototypeOf||(dr?function(e){return e.__proto__}:null),te={},mr=typeof Uint8Array>"u"||!j?x:j(Uint8Array),P={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?x:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?x:ArrayBuffer,"%ArrayIteratorPrototype%":ee&&j?j([][Symbol.iterator]()):x,"%AsyncFromSyncIteratorPrototype%":x,"%AsyncFunction%":te,"%AsyncGenerator%":te,"%AsyncGeneratorFunction%":te,"%AsyncIteratorPrototype%":te,"%Atomics%":typeof Atomics>"u"?x:Atomics,"%BigInt%":typeof BigInt>"u"?x:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?x:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?x:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?x:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":lr,"%eval%":eval,"%EvalError%":hr,"%Float32Array%":typeof Float32Array>"u"?x:Float32Array,"%Float64Array%":typeof Float64Array>"u"?x:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?x:FinalizationRegistry,"%Function%":vt,"%GeneratorFunction%":te,"%Int8Array%":typeof Int8Array>"u"?x:Int8Array,"%Int16Array%":typeof Int16Array>"u"?x:Int16Array,"%Int32Array%":typeof Int32Array>"u"?x:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ee&&j?j(j([][Symbol.iterator]())):x,"%JSON%":typeof JSON=="object"?JSON:x,"%Map%":typeof Map>"u"?x:Map,"%MapIteratorPrototype%":typeof Map>"u"||!ee||!j?x:j(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?x:Promise,"%Proxy%":typeof Proxy>"u"?x:Proxy,"%RangeError%":pr,"%ReferenceError%":vr,"%Reflect%":typeof Reflect>"u"?x:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?x:Set,"%SetIteratorPrototype%":typeof Set>"u"||!ee||!j?x:j(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?x:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ee&&j?j(""[Symbol.iterator]()):x,"%Symbol%":ee?Symbol:x,"%SyntaxError%":Q,"%ThrowTypeError%":gr,"%TypedArray%":mr,"%TypeError%":I,"%Uint8Array%":typeof Uint8Array>"u"?x:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?x:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?x:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?x:Uint32Array,"%URIError%":yr,"%WeakMap%":typeof WeakMap>"u"?x:WeakMap,"%WeakRef%":typeof WeakRef>"u"?x:WeakRef,"%WeakSet%":typeof WeakSet>"u"?x:WeakSet};if(j)try{null.error}catch(e){var wr=j(j(e));P["%Error.prototype%"]=wr}var Sr=function e(t){var r;if(t==="%AsyncFunction%")r=Le("async function () {}");else if(t==="%GeneratorFunction%")r=Le("function* () {}");else if(t==="%AsyncGeneratorFunction%")r=Le("async function* () {}");else if(t==="%AsyncGenerator%"){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(t==="%AsyncIteratorPrototype%"){var a=e("%AsyncGenerator%");a&&j&&(r=j(a.prototype))}return P[t]=r,r},yt={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},fe=pt,ge=fr,Er=fe.call(Function.call,Array.prototype.concat),Or=fe.call(Function.apply,Array.prototype.splice),gt=fe.call(Function.call,String.prototype.replace),de=fe.call(Function.call,String.prototype.slice),br=fe.call(Function.call,RegExp.prototype.exec),xr=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Tr=/\\(\\)?/g,kr=function(t){var r=de(t,0,1),n=de(t,-1);if(r==="%"&&n!=="%")throw new Q("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new Q("invalid intrinsic syntax, expected opening `%`");var a=[];return gt(t,xr,function(l,v,u,i){a[a.length]=u?gt(i,Tr,"$1"):v||l}),a},Rr=function(t,r){var n=t,a;if(ge(yt,n)&&(a=yt[n],n="%"+a[0]+"%"),ge(P,n)){var l=P[n];if(l===te&&(l=Sr(n)),typeof l>"u"&&!r)throw new I("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:a,name:n,value:l}}throw new Q("intrinsic "+t+" does not exist!")},dt=function(t,r){if(typeof t!="string"||t.length===0)throw new I("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new I('"allowMissing" argument must be a boolean');if(br(/^%?[^%]*%?$/,t)===null)throw new Q("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=kr(t),a=n.length>0?n[0]:"",l=Rr("%"+a+"%",r),v=l.name,u=l.value,i=!1,s=l.alias;s&&(a=s[0],Or(n,Er([0,1],s)));for(var c=1,h=!0;c<n.length;c+=1){var p=n[c],o=de(p,0,1),f=de(p,-1);if((o==='"'||o==="'"||o==="`"||f==='"'||f==="'"||f==="`")&&o!==f)throw new Q("property names with quotes must have matching quotes");if((p==="constructor"||!h)&&(i=!0),a+="."+p,v="%"+a+"%",ge(P,v))u=P[v];else if(u!=null){if(!(p in u)){if(!r)throw new I("base intrinsic for "+t+" exists, but the property is not available.");return}if(q&&c+1>=n.length){var y=q(u,p);h=!!y,h&&"get"in y&&!("originalValue"in y.get)?u=y.get:u=u[p]}else h=ge(u,p),u=u[p];h&&!i&&(P[v]=u)}}return u},Mr=dt,me=Mr("%Object.defineProperty%",!0)||!1;if(me)try{me({},"a",{value:1})}catch{me=!1}var mt=me,Dr=dt,we=Dr("%Object.getOwnPropertyDescriptor%",!0);if(we)try{we([],"length")}catch{we=null}var jr=we,wt=mt,Cr=ct,ne=ft,St=jr,_r=function(t,r,n){if(!t||typeof t!="object"&&typeof t!="function")throw new ne("`obj` must be an object or a function`");if(typeof r!="string"&&typeof r!="symbol")throw new ne("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new ne("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new ne("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new ne("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new ne("`loose`, if provided, must be a boolean");var a=arguments.length>3?arguments[3]:null,l=arguments.length>4?arguments[4]:null,v=arguments.length>5?arguments[5]:null,u=arguments.length>6?arguments[6]:!1,i=!!St&&St(t,r);if(wt)wt(t,r,{configurable:v===null&&i?i.configurable:!v,enumerable:a===null&&i?i.enumerable:!a,value:n,writable:l===null&&i?i.writable:!l});else if(u||!a&&!l&&!v)t[r]=n;else throw new Cr("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Fe=mt,Et=function(){return!!Fe};Et.hasArrayLengthDefineBug=function(){if(!Fe)return null;try{return Fe([],"length",{value:1}).length!==1}catch{return!0}};var Lr=Et,Ur=Vn,Fr=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",Br=Object.prototype.toString,$r=Array.prototype.concat,Ot=_r,zr=function(e){return typeof e=="function"&&Br.call(e)==="[object Function]"},bt=Lr(),Wr=function(e,t,r,n){if(t in e){if(n===!0){if(e[t]===r)return}else if(!zr(n)||!n())return}bt?Ot(e,t,r,!0):Ot(e,t,r)},xt=function(e,t){var r=arguments.length>2?arguments[2]:{},n=Ur(t);Fr&&(n=$r.call(n,Object.getOwnPropertySymbols(t)));for(var a=0;a<n.length;a+=1)Wr(e,n[a],t[n[a]],r[n[a]])};xt.supportsDescriptors=!!bt;var Tt=xt,Se={exports:{}};typeof self<"u"?Se.exports=self:typeof window<"u"?Se.exports=window:Se.exports=Function("return this")();var kt=Se.exports,Gr=kt,Rt=function(){return typeof B!="object"||!B||B.Math!==Math||B.Array!==Array?Gr:B},Nr=Tt,Vr=Rt,Kr=function(){var t=Vr();if(Nr.supportsDescriptors){var r=Object.getOwnPropertyDescriptor(t,"globalThis");(!r||r.configurable&&(r.enumerable||!r.writable||globalThis!==t))&&Object.defineProperty(t,"globalThis",{configurable:!0,enumerable:!1,value:t,writable:!0})}else(typeof globalThis!="object"||globalThis!==t)&&(t.globalThis=t);return t},qr=Tt,Pr=kt,Mt=Rt,Xr=Kr,Hr=Mt(),Dt=function(){return Hr};qr(Dt,{getPolyfill:Mt,implementation:Pr,shim:Xr});var Yr=Dt;const Ar=rt(Yr);function jt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jt(Object(r),!0).forEach(function(n){V(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jt(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var z=Ar(),Ct={vtkObject:function(){return null}};function X(e){if(e==null||e.isA)return e;if(!e.vtkClass)return z.console&&z.console.error&&z.console.error("Invalid VTK object"),null;var t=Ct[e.vtkClass];if(!t)return z.console&&z.console.error&&z.console.error("No vtk class found for Object of type ".concat(e.vtkClass)),null;var r=Jr({},e);Object.keys(r).forEach(function(a){r[a]&&K(r[a])==="object"&&r[a].vtkClass&&(r[a]=X(r[a]))});var n=t(r);return n&&n.modified&&n.modified(),n}function Zr(e,t){Ct[e]=t}X.register=Zr;function Qr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ir(e,t,r){return t&&_t(e.prototype,t),r&&_t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function H(e){return H=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},H(e)}function eo(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=H(e),e!==null););return e}function Ee(){return typeof Reflect<"u"&&Reflect.get?Ee=Reflect.get:Ee=function(t,r,n){var a=eo(t,r);if(a){var l=Object.getOwnPropertyDescriptor(a,r);return l.get?l.get.call(arguments.length<3?t:n):l.value}},Ee.apply(this,arguments)}function to(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ue(e,t)}function no(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ro(e,t){if(t&&(K(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return no(e)}function oo(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function Be(e){var t=typeof Map=="function"?new Map:void 0;return Be=function(n){if(n===null||!oo(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(n))return t.get(n);t.set(n,a)}function a(){return ce(n,arguments,H(this).constructor)}return a.prototype=Object.create(n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),ue(a,n)},Be(e)}function ao(e){var t=io();return function(){var n=H(e),a;if(t){var l=H(this).constructor;a=Reflect.construct(n,arguments,l)}else a=n.apply(this,arguments);return ro(this,a)}}function io(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var $e=function(e){to(r,e);var t=ao(r);function r(){return Qr(this,r),t.apply(this,arguments)}return Ir(r,[{key:"push",value:function(){for(var a=0;a<arguments.length;a++)this.includes(arguments[a])||Ee(H(r.prototype),"push",this).call(this,arguments[a]);return this.length}}]),r}(Be(Array));function Lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Oe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lt(Object(r),!0).forEach(function(n){V(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lt(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var ze=0,so=Symbol("void");function uo(){return ze}var Ut={};function Y(){}var co=["log","debug","info","warn","error","time","timeEnd","group","groupEnd"];co.forEach(function(e){Ut[e]=Y}),z.console=console.hasOwnProperty("log")?console:Ut;var F={debug:Y,error:z.console.error||Y,info:z.console.info||Y,log:z.console.log||Y,warn:z.console.warn||Y};function fo(e,t){F[e]&&(F[e]=t||Y)}function lo(){F.log.apply(F,arguments)}function ho(){F.info.apply(F,arguments)}function We(){F.debug.apply(F,arguments)}function C(){F.error.apply(F,arguments)}function Ft(){F.warn.apply(F,arguments)}var Bt={};function po(e){Bt[e]||(F.error(e),Bt[e]=!0)}var U=Object.create(null);U.Float32Array=Float32Array,U.Float64Array=Float64Array,U.Uint8Array=Uint8Array,U.Int8Array=Int8Array,U.Uint16Array=Uint16Array,U.Int16Array=Int16Array,U.Uint32Array=Uint32Array,U.Int32Array=Int32Array,U.Uint8ClampedArray=Uint8ClampedArray;try{U.BigInt64Array=BigInt64Array,U.BigUint64Array=BigUint64Array}catch{}function vo(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return ce(U[e]||Float64Array,r)}function yo(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return(t=U[e]||Float64Array).from.apply(t,n)}function Ge(e){return e.charAt(0).toUpperCase()+e.slice(1)}function D(e){return Ge(e[0]==="_"?e.slice(1):e)}function go(e){return e.charAt(0).toLowerCase()+e.slice(1)}function mo(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3,n=["TB","GB","MB","KB"],a=Number(e),l="B";a>r;)a/=r,l=n.pop();return"".concat(a.toFixed(t)," ").concat(l)}function wo(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ",r=[],n=e;n>1e3;)r.push("000".concat(n%1e3).slice(-3)),n=Math.floor(n/1e3);return n>0&&r.push(n),r.reverse(),r.join(t)}function $t(e){Object.keys(e).forEach(function(t){Array.isArray(e[t])&&(e[t]=[].concat(e[t]))})}function So(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}function Eo(e,t){return Object.keys(e).find(function(r){return e[r]===t})}function zt(e){return e&&e.isA?e.getState():e}function Wt(e){setTimeout(e,0)}function Oo(e,t){var r=performance.now();e.finally(function(){var n=performance.now()-r;t(n)})}function bo(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};$t(t);var r=[];if(Number.isInteger(t.mtime)||(t.mtime=++ze),!("classHierarchy"in t))t.classHierarchy=new $e("vtkObject");else if(!(t.classHierarchy instanceof $e)){for(var n=new $e,a=0;a<t.classHierarchy.length;a++)n.push(t.classHierarchy[a]);t.classHierarchy=n}function l(u){r[u]=null}function v(u){function i(){l(u)}return Object.freeze({unsubscribe:i})}return e.isDeleted=function(){return!!t.deleted},e.modified=function(u){if(t.deleted){C("instance deleted - cannot call any method");return}u&&u<e.getMTime()||(t.mtime=++ze,r.forEach(function(i){return i&&i(e)}))},e.onModified=function(u){if(t.deleted)return C("instance deleted - cannot call any method"),null;var i=r.length;return r.push(u),v(i)},e.getMTime=function(){return t.mtime},e.isA=function(u){for(var i=t.classHierarchy.length;i--;)if(t.classHierarchy[i]===u)return!0;return!1},e.getClassName=function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.classHierarchy[t.classHierarchy.length-1-u]},e.set=function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,c=!1;return Object.keys(u).forEach(function(h){var p=s?null:e["set".concat(Ge(h))];p&&Array.isArray(u[h])&&p.length>1?c=p.apply(void 0,se(u[h]))||c:p?c=p(u[h])||c:(["mtime"].indexOf(h)===-1&&!i&&Ft("Warning: Set value to model directly ".concat(h,", ").concat(u[h])),c=t[h]!==u[h]||c,t[h]=u[h])}),c},e.get=function(){for(var u=arguments.length,i=new Array(u),s=0;s<u;s++)i[s]=arguments[s];if(!i.length)return t;var c={};return i.forEach(function(h){c[h]=t[h]}),c},e.getReferenceByName=function(u){return t[u]},e.delete=function(){Object.keys(t).forEach(function(u){return delete t[u]}),r.forEach(function(u,i){return l(i)}),t.deleted=!0},e.getState=function(){if(t.deleted)return null;var u=Oe(Oe({},t),{},{vtkClass:e.getClassName()});Object.keys(u).forEach(function(s){u[s]===null||u[s]===void 0||s[0]==="_"?delete u[s]:u[s].isA?u[s]=u[s].getState():Array.isArray(u[s])&&(u[s]=u[s].map(zt))});var i={};return Object.keys(u).sort().forEach(function(s){i[s]=u[s]}),i.mtime&&delete i.mtime,i},e.shallowCopy=function(u){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(u.getClassName()!==e.getClassName())throw new Error("Cannot ShallowCopy ".concat(u.getClassName()," into ").concat(e.getClassName()));var s=u.get(),c=Object.keys(t).sort(),h=Object.keys(s).sort();h.forEach(function(p){var o=c.indexOf(p);o===-1?i&&We("add ".concat(p," in shallowCopy")):c.splice(o,1),t[p]=s[p]}),c.length&&i&&We("Untouched keys: ".concat(c.join(", "))),e.modified()},e.toJSON=function(){return e.getState()},e}var xo={object:function(t,r,n){return function(){return Oe({},r[n.name])}}};function be(e,t,r){r.forEach(function(n){if(K(n)==="object"){var a=xo[n.type];a?e["get".concat(D(n.name))]=a(e,t,n):e["get".concat(D(n.name))]=function(){return t[n.name]}}else e["get".concat(D(n))]=function(){return t[n]}})}var To={enum:function(t,r,n){var a="_on".concat(D(n.name),"Changed");return function(l){if(typeof l=="string"){if(n.enum[l]!==void 0)return r[n.name]!==n.enum[l]?(r[n.name]=n.enum[l],t.modified(),!0):!1;throw C("Set Enum with invalid argument ".concat(n,", ").concat(l)),new RangeError("Set Enum with invalid string argument")}if(typeof l=="number"){if(r[n.name]!==l){if(Object.keys(n.enum).map(function(i){return n.enum[i]}).indexOf(l)!==-1){var v,u=r[n.name];return r[n.name]=l,(v=r[a])===null||v===void 0||v.call(r,t,r,l,u),t.modified(),!0}throw C("Set Enum outside numeric range ".concat(n,", ").concat(l)),new RangeError("Set Enum outside numeric range")}return!1}throw C("Set Enum with invalid argument (String/Number) ".concat(n,", ").concat(l)),new TypeError("Set Enum with invalid argument (String/Number)")}},object:function(t,r,n){var a="_on".concat(D(n.name),"Changed");return function(l){if(!zn(r[n.name],l)){var v,u=r[n.name];return r[n.name]=l,(v=r[a])===null||v===void 0||v.call(r,t,r,l,u),t.modified(),!0}return!1}}};function Gt(e){if(K(e)==="object"){var t=To[e.type];if(t)return function(r,n){return t(r,n,e)};throw C("No setter for field ".concat(e)),new TypeError("No setter for field")}return function(n,a){var l="_on".concat(D(e),"Changed");return function(u){if(a.deleted)return C("instance deleted - cannot call any method"),!1;if(a[e]!==u){var i,s=a[e.name];return a[e]=u,(i=a[l])===null||i===void 0||i.call(a,n,a,u,s),n.modified(),!0}return!1}}}function Nt(e,t,r){r.forEach(function(n){K(n)==="object"?e["set".concat(D(n.name))]=Gt(n)(e,t):e["set".concat(D(n))]=Gt(n)(e,t)})}function Vt(e,t,r){be(e,t,r),Nt(e,t,r)}function Kt(e,t,r){r.forEach(function(n){e["get".concat(D(n))]=function(){return t[n]?Array.from(t[n]):t[n]},e["get".concat(D(n),"ByReference")]=function(){return t[n]}})}function qt(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;r.forEach(function(l){if(t[l]&&n&&t[l].length!==n)throw new RangeError("Invalid initial number of values for array (".concat(l,")"));var v="_on".concat(D(l),"Changed");e["set".concat(D(l))]=function(){if(t.deleted)return C("instance deleted - cannot call any method"),!1;for(var u=arguments.length,i=new Array(u),s=0;s<u;s++)i[s]=arguments[s];var c=i,h,p=!1;if(c.length===1&&(c[0]==null||c[0].length>=0)&&(c=c[0],p=!0),c==null)h=t[l]!==c;else{if(n&&c.length!==n)if(c.length<n&&a!==void 0)for(c=Array.from(c),p=!1;c.length<n;)c.push(a);else throw new RangeError("Invalid number of values for array setter (".concat(l,")"));h=t[l]==null||t[l].length!==c.length;for(var o=0;!h&&o<c.length;++o)h=t[l][o]!==c[o];h&&p&&(c=Array.from(c))}if(h){var f,y=t[l.name];t[l]=c,(f=t[v])===null||f===void 0||f.call(t,e,t,c,y),e.modified()}return h},e["set".concat(D(l),"From")]=function(u){var i=t[l];u.forEach(function(s,c){i[c]=s})}})}function ko(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;Kt(e,t,r),qt(e,t,r,n,a)}function Ro(e,t,r){for(var n=0;n<r.length;n++){var a=r[n];t[a]!==void 0&&(t["_".concat(a)]=t[a],delete t[a])}}function Mo(e,t,r,n){t.inputData?t.inputData=t.inputData.map(X):t.inputData=[],t.inputConnection?t.inputConnection=t.inputConnection.map(X):t.inputConnection=[],t.output?t.output=t.output.map(X):t.output=[],t.inputArrayToProcess?t.inputArrayToProcess=t.inputArrayToProcess.map(X):t.inputArrayToProcess=[],t.numberOfInputs=r;function a(f){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(t.deleted){C("instance deleted - cannot call any method");return}if(y>=t.numberOfInputs){C("algorithm ".concat(e.getClassName()," only has ").concat(t.numberOfInputs," input ports. To add more input ports, use addInputData()"));return}(t.inputData[y]!==f||t.inputConnection[y])&&(t.inputData[y]=f,t.inputConnection[y]=null,e.modified&&e.modified())}function l(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.inputConnection[f]&&(t.inputData[f]=t.inputConnection[f]()),t.inputData[f]}function v(f){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(t.deleted){C("instance deleted - cannot call any method");return}if(y>=t.numberOfInputs){var d="algorithm ".concat(e.getClassName()," only has ");d+="".concat(t.numberOfInputs),d+=" input ports. To add more input ports, use addInputConnection()",C(d);return}t.inputData[y]=null,t.inputConnection[y]=f}function u(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.inputConnection[f]}function i(){for(var f=t.numberOfInputs;f&&!t.inputData[f-1]&&!t.inputConnection[f-1];)f--;return f===t.numberOfInputs&&t.numberOfInputs++,f}function s(f){if(t.deleted){C("instance deleted - cannot call any method");return}v(f,i())}function c(f){if(t.deleted){C("instance deleted - cannot call any method");return}a(f,i())}function h(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.deleted?(C("instance deleted - cannot call any method"),null):(e.shouldUpdate()&&e.update(),t.output[f])}e.shouldUpdate=function(){for(var f=e.getMTime(),y=1/0,d=n;d--;){if(!t.output[d]||t.output[d].isDeleted())return!0;var m=t.output[d].getMTime();if(m<f)return!0;m<y&&(y=m)}for(d=t.numberOfInputs;d--;){var w,T;if((w=t.inputConnection[d])!==null&&w!==void 0&&w.filter.shouldUpdate()||((T=e.getInputData(d))===null||T===void 0?void 0:T.getMTime())>y)return!0}return!1};function p(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,y=function(){return h(f)};return y.filter=e,y}if(t.numberOfInputs){for(var o=t.numberOfInputs;o--;)t.inputData.push(null),t.inputConnection.push(null);e.setInputData=a,e.setInputConnection=v,e.addInputData=c,e.addInputConnection=s,e.getInputData=l,e.getInputConnection=u}n&&(e.getOutputData=h,e.getOutputPort=p),e.update=function(){var f=[];if(t.numberOfInputs)for(var y=0;y<t.numberOfInputs;)f[y]=e.getInputData(y),y++;e.shouldUpdate()&&e.requestData&&e.requestData(f,t.output)},e.getNumberOfInputPorts=function(){return t.numberOfInputs},e.getNumberOfOutputPorts=function(){return n||t.output.length},e.getInputArrayToProcess=function(f){var y=t.inputArrayToProcess[f],d=t.inputData[f];return y&&d?d["get".concat(y.fieldAssociation)]().getArray(y.arrayName):null},e.setInputArrayToProcess=function(f,y,d){for(var m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Scalars";t.inputArrayToProcess.length<f;)t.inputArrayToProcess.push(null);t.inputArrayToProcess[f]={arrayName:y,fieldAssociation:d,attributeType:m}}}var Pt=Symbol("Event abort");function Do(e,t,r){var n=[],a=e.delete,l=1;function v(s){for(var c=0;c<n.length;++c){var h=je(n[c],1),p=h[0];if(p===s){n.splice(c,1);return}}}function u(s){function c(){v(s)}return Object.freeze({unsubscribe:c})}function i(){var s=arguments;if(t.deleted){C("instance deleted - cannot call any method");return}for(var c=n.slice(),h=function(y){var d=je(c[y],3),m=d[1],w=d[2];if(!m)return"continue";if(w<0)setTimeout(function(){return m.apply(e,s)},1-w);else{var T=m.apply(e,s);if(T===Pt)return"break"}},p=0;p<c.length;++p){var o=h(p);if(o!=="continue"&&o==="break")break}}e["invoke".concat(D(r))]=i,e["on".concat(D(r))]=function(s){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!s.apply)return console.error("Invalid callback for event ".concat(r)),null;if(t.deleted)return C("instance deleted - cannot call any method"),null;var h=l++;return n.push([h,s,c]),n.sort(function(p,o){return o[2]-p[2]}),u(h)},e.delete=function(){a(),n.forEach(function(s){var c=je(s,1),h=c[0];return v(h)})}}function jo(e,t){var r=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l={},v={};return e(v,l,a),Object.freeze(v)};return t&&X.register(t,r),r}function Co(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(){for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return t.filter(function(v){return!!v}).map(function(v){return v.apply(void 0,a)})}}function Xt(e){return e&&e.isA&&e.isA("vtkObject")}function Ne(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(Xt(e)){if(n.indexOf(e)>=0)return r;n.push(e);var a=t(e);a!==void 0&&r.push(a);var l=e.get();Object.keys(l).forEach(function(v){var u=l[v];Array.isArray(u)?u.forEach(function(i){Ne(i,t,r,n)}):Ne(u,t,r,n)})}return r}function _o(e,t,r){var n=this,a,l=function(){for(var u=arguments.length,i=new Array(u),s=0;s<u;s++)i[s]=arguments[s];var c=n,h=function(){a=null,r||e.apply(c,i)},p=r&&!a;clearTimeout(a),a=setTimeout(h,t),p&&e.apply(c,i)};return l.cancel=function(){return clearTimeout(a)},l}function Lo(e,t){var r=!1,n=null;function a(){r=!1,n!==null&&(l.apply(void 0,se(n)),n=null)}function l(){for(var v=arguments.length,u=new Array(v),i=0;i<v;i++)u[i]=arguments[i];if(r){n=u;return}r=!0,e.apply(void 0,u),setTimeout(a,t)}return l}function Ht(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};t.keystore=Object.assign(t.keystore||{},r),e.setKey=function(n,a){t.keystore[n]=a},e.getKey=function(n){return t.keystore[n]},e.getAllKeys=function(){return Object.keys(t.keystore)},e.deleteKey=function(n){return delete t.keystore[n]},e.clearKeystore=function(){return e.getAllKeys().forEach(function(n){return delete t.keystore[n]})}}var Uo=1,xe="__root__";function Fo(e,t){Ht(e,t);var r=e.delete;t.proxyId="".concat(Uo++),t.ui=JSON.parse(JSON.stringify(t.ui||[])),be(e,t,["proxyId","proxyGroup","proxyName"]),Vt(e,t,["proxyManager"]);var n={},a={};function l(s,c){a[c]||(a[c]=[]);for(var h=a[c],p=0;p<s.length;p++)h.push(s[p].name),n[s[p].name]=s[p],s[p].children&&s[p].children.length&&l(s[p].children,s[p].name)}l(t.ui,xe),e.updateUI=function(s){t.ui=JSON.parse(JSON.stringify(s||[])),Object.keys(n).forEach(function(c){return delete n[c]}),Object.keys(a).forEach(function(c){return delete a[c]}),l(t.ui,xe),e.modified()};function v(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xe;return a[s]}e.updateProxyProperty=function(s,c){var h=n[s];h?Object.assign(h,c):n[s]=Oe({},c)},e.activate=function(){if(t.proxyManager){var s="setActive".concat(D(e.getProxyGroup().slice(0,-1)));t.proxyManager[s]&&t.proxyManager[s](e)}},t.propertyLinkSubscribers={},e.registerPropertyLinkForGC=function(s,c){c in t.propertyLinkSubscribers||(t.propertyLinkSubscribers[c]=[]),t.propertyLinkSubscribers[c].push(s)},e.gcPropertyLinks=function(s){for(var c=t.propertyLinkSubscribers[s]||[];c.length;)c.pop().unbind(e)},t.propertyLinkMap={},e.getPropertyLink=function(s){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t.propertyLinkMap[s])return t.propertyLinkMap[s];var h=null,p=[],o=0,f=!1;function y(g){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(f)return null;var E=[],O=null;for(o=p.length;o--;){var b=p[o];b.instance===g?O=b:E.push(b)}if(!O)return null;var M=O.instance["get".concat(D(O.propertyName))]();if(!So(M,h)||S){for(h=M,f=!0;E.length;){var _=E.pop();_.instance.set(V({},_.propertyName,h))}f=!1}return t.propertyLinkMap[s].persistent&&(t.propertyLinkMap[s].value=M),M}function d(g,S){var E=[];for(o=p.length;o--;){var O=p[o];O.instance===g&&(O.propertyName===S||S===void 0)&&(O.subscription.unsubscribe(),E.push(o))}for(;E.length;)p.splice(E.pop(),1)}function m(g,S){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=g.onModified(y),b=p[0];return p.push({instance:g,propertyName:S,subscription:O}),E&&(t.propertyLinkMap[s].persistent&&t.propertyLinkMap[s].value!==void 0?g.set(V({},S,t.propertyLinkMap[s].value)):b&&y(b.instance,!0)),{unsubscribe:function(){return d(g,S)}}}function w(){for(;p.length;)p.pop().subscription.unsubscribe()}var T={bind:m,unbind:d,unsubscribe:w,persistent:c};return t.propertyLinkMap[s]=T,T};function u(){for(var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xe,c=[],h=t.proxyId,p=v(s)||[],o=0;o<p.length;o++){var f=p[o],y=e["get".concat(D(f))],d=y?y():void 0,m={id:h,name:f,value:d},w=u(f);w.length&&(m.children=w),c.push(m)}return c}e.listPropertyNames=function(){return u().map(function(s){return s.name})},e.getPropertyByName=function(s){return u().find(function(c){return c.name===s})},e.getPropertyDomainByName=function(s){return(n[s]||{}).domain},e.getProxySection=function(){return{id:t.proxyId,name:t.proxyGroup,ui:t.ui,properties:u()}},e.delete=function(){for(var s=Object.keys(t.propertyLinkMap),c=s.length;c--;)t.propertyLinkMap[s[c]].unsubscribe();Object.keys(t.propertyLinkSubscribers).forEach(e.gcPropertyLinks),r()},e.getState=function(){return null};function i(){if(t.links)for(var s=0;s<t.links.length;s++){var c=t.links[s],h=c.link,p=c.property,o=c.persistent,f=c.updateOnBind,y=c.type;if(y==="application"){var d=t.proxyManager.getPropertyLink(h,o);e.registerPropertyLinkForGC(d,"application"),d.bind(e,p,f)}}}Wt(i)}function Bo(e,t,r){for(var n=e.delete,a=[],l=Object.keys(r),v=l.length;v--;){var u=l[v],i=r[u],s=i.modelKey,c=i.property,h=i.modified,p=h===void 0?!0:h,o=D(c),f=D(u);e["get".concat(f)]=t[s]["get".concat(o)],e["set".concat(f)]=t[s]["set".concat(o)],p&&a.push(t[s].onModified(e.modified))}e.delete=function(){for(;a.length;)a.pop().unsubscribe();n()}}function $o(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};t.this=e;function a(i){for(var s=Object.keys(i),c=s.length;c--;){var h=s[c];t[h].set(i[h])}}for(var l=Object.keys(n),v=l.length,u=function(){var s=l[v];t[s]=n[s];var c=r[s];e["set".concat(D(s))]=function(h){if(h!==t[s]){t[s]=h;var p=c[h];a(p),e.modified()}}};v--;)u();l.length&&be(e,t,l)}var Yt=10,At=40,Jt=800;function zo(e){var t=0,r=0,n=0,a=0;return"detail"in e&&(r=e.detail),"wheelDelta"in e&&(r=-e.wheelDelta/120),"wheelDeltaY"in e&&(r=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=r,r=0),n=t*Yt,a=r*Yt,"deltaY"in e&&(a=e.deltaY),"deltaX"in e&&(n=e.deltaX),(n||a)&&e.deltaMode&&(e.deltaMode===1?(n*=At,a*=At):(n*=Jt,a*=Jt)),n&&!t&&(t=n<1?-1:1),a&&!r&&(r=a<1?-1:1),{spinX:t,spinY:r,pixelX:n,pixelY:a}}var k={algo:Mo,capitalize:Ge,chain:Co,debounce:_o,enumToString:Eo,event:Do,EVENT_ABORT:Pt,formatBytesToProperUnit:mo,formatNumbersWithThousandSeparator:wo,get:be,getArray:Kt,getCurrentGlobalMTime:uo,getStateArrayMapFunc:zt,isVtkObject:Xt,keystore:Ht,measurePromiseExecution:Oo,moveToProtected:Ro,newInstance:jo,newTypedArray:vo,newTypedArrayFrom:yo,normalizeWheel:zo,obj:bo,proxy:Fo,proxyPropertyMapping:Bo,proxyPropertyState:$o,safeArrays:$t,set:Nt,setArray:qt,setGet:Vt,setGetArray:ko,setImmediate:Wt,setLoggerFunction:fo,throttle:Lo,traverseInstanceTree:Ne,TYPED_ARRAYS:U,uncapitalize:go,VOID:so,vtkDebugMacro:We,vtkErrorMacro:C,vtkInfoMacro:ho,vtkLogMacro:lo,vtkOnceErrorMacro:po,vtkWarningMacro:Ft},Ve={exports:{}};Ve.exports,function(e){(function(t,r,n){function a(i){var s=this,c=u();s.next=function(){var h=2091639*s.s0+s.c*23283064365386963e-26;return s.s0=s.s1,s.s1=s.s2,s.s2=h-(s.c=h|0)},s.c=1,s.s0=c(" "),s.s1=c(" "),s.s2=c(" "),s.s0-=c(i),s.s0<0&&(s.s0+=1),s.s1-=c(i),s.s1<0&&(s.s1+=1),s.s2-=c(i),s.s2<0&&(s.s2+=1),c=null}function l(i,s){return s.c=i.c,s.s0=i.s0,s.s1=i.s1,s.s2=i.s2,s}function v(i,s){var c=new a(i),h=s&&s.state,p=c.next;return p.int32=function(){return c.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,h&&(typeof h=="object"&&l(h,c),p.state=function(){return l(c,{})}),p}function u(){var i=4022871197,s=function(c){c=String(c);for(var h=0;h<c.length;h++){i+=c.charCodeAt(h);var p=.02519603282416938*i;i=p>>>0,p-=i,p*=i,i=p>>>0,p-=i,i+=p*4294967296}return(i>>>0)*23283064365386963e-26};return s}r&&r.exports?r.exports=v:n&&n.amd?n(function(){return v}):this.alea=v})(B,e,!1)}(Ve);var Wo=Ve.exports,Ke={exports:{}};Ke.exports,function(e){(function(t,r,n){function a(u){var i=this,s="";i.x=0,i.y=0,i.z=0,i.w=0,i.next=function(){var h=i.x^i.x<<11;return i.x=i.y,i.y=i.z,i.z=i.w,i.w^=i.w>>>19^h^h>>>8},u===(u|0)?i.x=u:s+=u;for(var c=0;c<s.length+64;c++)i.x^=s.charCodeAt(c)|0,i.next()}function l(u,i){return i.x=u.x,i.y=u.y,i.z=u.z,i.w=u.w,i}function v(u,i){var s=new a(u),c=i&&i.state,h=function(){return(s.next()>>>0)/4294967296};return h.double=function(){do var p=s.next()>>>11,o=(s.next()>>>0)/4294967296,f=(p+o)/(1<<21);while(f===0);return f},h.int32=s.next,h.quick=h,c&&(typeof c=="object"&&l(c,s),h.state=function(){return l(s,{})}),h}r&&r.exports?r.exports=v:n&&n.amd?n(function(){return v}):this.xor128=v})(B,e,!1)}(Ke);var Go=Ke.exports,qe={exports:{}};qe.exports,function(e){(function(t,r,n){function a(u){var i=this,s="";i.next=function(){var h=i.x^i.x>>>2;return i.x=i.y,i.y=i.z,i.z=i.w,i.w=i.v,(i.d=i.d+362437|0)+(i.v=i.v^i.v<<4^(h^h<<1))|0},i.x=0,i.y=0,i.z=0,i.w=0,i.v=0,u===(u|0)?i.x=u:s+=u;for(var c=0;c<s.length+64;c++)i.x^=s.charCodeAt(c)|0,c==s.length&&(i.d=i.x<<10^i.x>>>4),i.next()}function l(u,i){return i.x=u.x,i.y=u.y,i.z=u.z,i.w=u.w,i.v=u.v,i.d=u.d,i}function v(u,i){var s=new a(u),c=i&&i.state,h=function(){return(s.next()>>>0)/4294967296};return h.double=function(){do var p=s.next()>>>11,o=(s.next()>>>0)/4294967296,f=(p+o)/(1<<21);while(f===0);return f},h.int32=s.next,h.quick=h,c&&(typeof c=="object"&&l(c,s),h.state=function(){return l(s,{})}),h}r&&r.exports?r.exports=v:n&&n.amd?n(function(){return v}):this.xorwow=v})(B,e,!1)}(qe);var No=qe.exports,Pe={exports:{}};Pe.exports,function(e){(function(t,r,n){function a(u){var i=this;i.next=function(){var c=i.x,h=i.i,p,o;return p=c[h],p^=p>>>7,o=p^p<<24,p=c[h+1&7],o^=p^p>>>10,p=c[h+3&7],o^=p^p>>>3,p=c[h+4&7],o^=p^p<<7,p=c[h+7&7],p=p^p<<13,o^=p^p<<9,c[h]=o,i.i=h+1&7,o};function s(c,h){var p,o=[];if(h===(h|0))o[0]=h;else for(h=""+h,p=0;p<h.length;++p)o[p&7]=o[p&7]<<15^h.charCodeAt(p)+o[p+1&7]<<13;for(;o.length<8;)o.push(0);for(p=0;p<8&&o[p]===0;++p);for(p==8?o[7]=-1:o[p],c.x=o,c.i=0,p=256;p>0;--p)c.next()}s(i,u)}function l(u,i){return i.x=u.x.slice(),i.i=u.i,i}function v(u,i){u==null&&(u=+new Date);var s=new a(u),c=i&&i.state,h=function(){return(s.next()>>>0)/4294967296};return h.double=function(){do var p=s.next()>>>11,o=(s.next()>>>0)/4294967296,f=(p+o)/(1<<21);while(f===0);return f},h.int32=s.next,h.quick=h,c&&(c.x&&l(c,s),h.state=function(){return l(s,{})}),h}r&&r.exports?r.exports=v:n&&n.amd?n(function(){return v}):this.xorshift7=v})(B,e,!1)}(Pe);var Vo=Pe.exports,Xe={exports:{}};Xe.exports,function(e){(function(t,r,n){function a(u){var i=this;i.next=function(){var c=i.w,h=i.X,p=i.i,o,f;return i.w=c=c+1640531527|0,f=h[p+34&127],o=h[p=p+1&127],f^=f<<13,o^=o<<17,f^=f>>>15,o^=o>>>12,f=h[p]=f^o,i.i=p,f+(c^c>>>16)|0};function s(c,h){var p,o,f,y,d,m=[],w=128;for(h===(h|0)?(o=h,h=null):(h=h+"\0",o=0,w=Math.max(w,h.length)),f=0,y=-32;y<w;++y)h&&(o^=h.charCodeAt((y+32)%h.length)),y===0&&(d=o),o^=o<<10,o^=o>>>15,o^=o<<4,o^=o>>>13,y>=0&&(d=d+1640531527|0,p=m[y&127]^=o+d,f=p==0?f+1:0);for(f>=128&&(m[(h&&h.length||0)&127]=-1),f=127,y=4*128;y>0;--y)o=m[f+34&127],p=m[f=f+1&127],o^=o<<13,p^=p<<17,o^=o>>>15,p^=p>>>12,m[f]=o^p;c.w=d,c.X=m,c.i=f}s(i,u)}function l(u,i){return i.i=u.i,i.w=u.w,i.X=u.X.slice(),i}function v(u,i){u==null&&(u=+new Date);var s=new a(u),c=i&&i.state,h=function(){return(s.next()>>>0)/4294967296};return h.double=function(){do var p=s.next()>>>11,o=(s.next()>>>0)/4294967296,f=(p+o)/(1<<21);while(f===0);return f},h.int32=s.next,h.quick=h,c&&(c.X&&l(c,s),h.state=function(){return l(s,{})}),h}r&&r.exports?r.exports=v:n&&n.amd?n(function(){return v}):this.xor4096=v})(B,e,!1)}(Xe);var Ko=Xe.exports,He={exports:{}};He.exports,function(e){(function(t,r,n){function a(u){var i=this,s="";i.next=function(){var h=i.b,p=i.c,o=i.d,f=i.a;return h=h<<25^h>>>7^p,p=p-o|0,o=o<<24^o>>>8^f,f=f-h|0,i.b=h=h<<20^h>>>12^p,i.c=p=p-o|0,i.d=o<<16^p>>>16^f,i.a=f-h|0},i.a=0,i.b=0,i.c=-1640531527,i.d=1367130551,u===Math.floor(u)?(i.a=u/4294967296|0,i.b=u|0):s+=u;for(var c=0;c<s.length+20;c++)i.b^=s.charCodeAt(c)|0,i.next()}function l(u,i){return i.a=u.a,i.b=u.b,i.c=u.c,i.d=u.d,i}function v(u,i){var s=new a(u),c=i&&i.state,h=function(){return(s.next()>>>0)/4294967296};return h.double=function(){do var p=s.next()>>>11,o=(s.next()>>>0)/4294967296,f=(p+o)/(1<<21);while(f===0);return f},h.int32=s.next,h.quick=h,c&&(typeof c=="object"&&l(c,s),h.state=function(){return l(s,{})}),h}r&&r.exports?r.exports=v:n&&n.amd?n(function(){return v}):this.tychei=v})(B,e,!1)}(He);var qo=He.exports,Zt={exports:{}};const Po=Bn(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));(function(e){(function(t,r,n){var a=256,l=6,v=52,u="random",i=n.pow(a,l),s=n.pow(2,v),c=s*2,h=a-1,p;function o(g,S,E){var O=[];S=S==!0?{entropy:!0}:S||{};var b=m(d(S.entropy?[g,T(r)]:g??w(),3),O),M=new f(O),_=function(){for(var L=M.g(l),W=i,$=0;L<s;)L=(L+$)*a,W*=a,$=M.g(1);for(;L>=c;)L/=2,W/=2,$>>>=1;return(L+$)/W};return _.int32=function(){return M.g(4)|0},_.quick=function(){return M.g(4)/4294967296},_.double=_,m(T(M.S),r),(S.pass||E||function(L,W,$,N){return N&&(N.S&&y(N,M),L.state=function(){return y(M,{})}),$?(n[u]=L,W):L})(_,b,"global"in S?S.global:this==n,S.state)}function f(g){var S,E=g.length,O=this,b=0,M=O.i=O.j=0,_=O.S=[];for(E||(g=[E++]);b<a;)_[b]=b++;for(b=0;b<a;b++)_[b]=_[M=h&M+g[b%E]+(S=_[b])],_[M]=S;(O.g=function(L){for(var W,$=0,N=O.i,ae=O.j,J=O.S;L--;)W=J[N=h&N+1],$=$*a+J[h&(J[N]=J[ae=h&ae+W])+(J[ae]=W)];return O.i=N,O.j=ae,$})(a)}function y(g,S){return S.i=g.i,S.j=g.j,S.S=g.S.slice(),S}function d(g,S){var E=[],O=typeof g,b;if(S&&O=="object")for(b in g)try{E.push(d(g[b],S-1))}catch{}return E.length?E:O=="string"?g:g+"\0"}function m(g,S){for(var E=g+"",O,b=0;b<E.length;)S[h&b]=h&(O^=S[h&b]*19)+E.charCodeAt(b++);return T(S)}function w(){try{var g;return p&&(g=p.randomBytes)?g=g(a):(g=new Uint8Array(a),(t.crypto||t.msCrypto).getRandomValues(g)),T(g)}catch{var S=t.navigator,E=S&&S.plugins;return[+new Date,t,E,t.screen,T(r)]}}function T(g){return String.fromCharCode.apply(0,g)}if(m(n.random(),r),e.exports){e.exports=o;try{p=Po}catch{}}else n["seed"+u]=o})(typeof self<"u"?self:B,[],Math)})(Zt);var Xo=Zt.exports,Ho=Wo,Yo=Go,Ao=No,Jo=Vo,Zo=Ko,Qo=qo,re=Xo;re.alea=Ho,re.xor128=Yo,re.xorwow=Ao,re.xorshift7=Jo,re.xor4096=Zo,re.tychei=Qo;function Qt(e){return e*180/Math.PI}var Io={Unknown:0,LeftController:1,RightController:2},ea={Unknown:0,Trigger:1,TrackPad:2,Grip:3,Thumbstick:4,A:5,B:6,ApplicationMenu:7},ta={Unknown:0,TouchpadX:1,TouchpadY:2,ThumbstickX:3,ThumbstickY:4},Ye={Device:Io,Input:ea,Axis:ta};function It(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?It(Object(r),!0).forEach(function(n){V(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):It(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var Te=Ye.Device,A=Ye.Input,ke=k.vtkWarningMacro,Re=k.vtkErrorMacro,na=k.normalizeWheel,ra=k.vtkOnceErrorMacro,oe=new MouseEvent(""),Ae={"xr-standard":[A.Trigger,A.Grip,A.TrackPad,A.Thumbstick,A.A,A.B]},Je=["StartAnimation","Animation","EndAnimation","PointerEnter","PointerLeave","MouseEnter","MouseLeave","StartMouseMove","MouseMove","EndMouseMove","LeftButtonPress","LeftButtonRelease","MiddleButtonPress","MiddleButtonRelease","RightButtonPress","RightButtonRelease","KeyPress","KeyDown","KeyUp","StartMouseWheel","MouseWheel","EndMouseWheel","StartPinch","Pinch","EndPinch","StartPan","Pan","EndPan","StartRotate","Rotate","EndRotate","Button3D","Move3D","StartPointerLock","EndPointerLock","StartInteraction","Interaction","EndInteraction","AnimationFrameRateUpdate"];function le(e){e.cancelable&&e.preventDefault()}function Me(e){var t=Object.create(null);return e.forEach(function(r){var n=r.pointerId,a=r.position;t[n]=a}),t}function oa(e,t){t.classHierarchy.push("vtkRenderWindowInteractor");var r=new Set,n=new Map,a=1;e.start=function(){!t.initialized&&(e.initialize(),!t.initialized)||e.startEventLoop()},e.setRenderWindow=function(o){Re("you want to call setView(view) instead of setRenderWindow on a vtk.js interactor")},e.setInteractorStyle=function(o){t.interactorStyle!==o&&(t.interactorStyle!=null&&t.interactorStyle.setInteractor(null),t.interactorStyle=o,t.interactorStyle!=null&&t.interactorStyle.getInteractor()!==e&&t.interactorStyle.setInteractor(e))},e.initialize=function(){t.initialized=!0,e.enable(),e.render()},e.enable=function(){return e.setEnabled(!0)},e.disable=function(){return e.setEnabled(!1)},e.startEventLoop=function(){return ke("empty event loop")};function l(o,f){t._forcedRenderer||(t.currentRenderer=e.findPokedRenderer(o,f))}e.getCurrentRenderer=function(){return t.currentRenderer||l(0,0),t.currentRenderer};function v(o){var f=t._view.getCanvas(),y=f.getBoundingClientRect(),d=f.width/y.width,m=f.height/y.height,w={x:d*(o.clientX-y.left),y:m*(y.height-o.clientY+y.top),z:0};return(n.size<=1||!t.currentRenderer)&&l(w.x,w.y),w}var u=t._getScreenEventPositionFor||v;function i(o){return{controlKey:o.ctrlKey,altKey:o.altKey,shiftKey:o.shiftKey}}function s(o){var f=i(o),y=R({key:o.key,keyCode:o.charCode},f);return y}function c(o){return o.pointerType||""}e.bindEvents=function(o){t.container=o,o.addEventListener("contextmenu",le),o.addEventListener("wheel",e.handleWheel),o.addEventListener("DOMMouseScroll",e.handleWheel),o.addEventListener("pointerenter",e.handlePointerEnter),o.addEventListener("pointerleave",e.handlePointerLeave),o.addEventListener("pointermove",e.handlePointerMove,{passive:!1}),o.addEventListener("pointerdown",e.handlePointerDown,{passive:!1}),o.addEventListener("pointerup",e.handlePointerUp),o.addEventListener("pointercancel",e.handlePointerCancel),document.addEventListener("keypress",e.handleKeyPress),document.addEventListener("keydown",e.handleKeyDown),document.addEventListener("keyup",e.handleKeyUp),document.addEventListener("pointerlockchange",e.handlePointerLockChange),o.style.touchAction="none",o.style.userSelect="none",o.style.webkitTapHighlightColor="rgba(0,0,0,0)"},e.unbindEvents=function(){var o=t.container;o.removeEventListener("contextmenu",le),o.removeEventListener("wheel",e.handleWheel),o.removeEventListener("DOMMouseScroll",e.handleWheel),o.removeEventListener("pointerenter",e.handlePointerEnter),o.removeEventListener("pointerleave",e.handlePointerLeave),o.removeEventListener("pointermove",e.handlePointerMove,{passive:!1}),o.removeEventListener("pointerdown",e.handlePointerDown,{passive:!1}),o.removeEventListener("pointerup",e.handlePointerUp),o.removeEventListener("pointercancel",e.handlePointerCancel),document.removeEventListener("keypress",e.handleKeyPress),document.removeEventListener("keydown",e.handleKeyDown),document.removeEventListener("keyup",e.handleKeyUp),document.removeEventListener("pointerlockchange",e.handlePointerLockChange),t.container=null,n.clear()},e.handleKeyPress=function(o){var f=s(o);e.keyPressEvent(f)},e.handleKeyDown=function(o){var f=s(o);e.keyDownEvent(f)},e.handleKeyUp=function(o){var f=s(o);e.keyUpEvent(f)},e.handlePointerEnter=function(o){var f=R(R({},i(o)),{},{position:u(o),deviceType:c(o)});e.pointerEnterEvent(f),f.deviceType==="mouse"&&e.mouseEnterEvent(f)},e.handlePointerLeave=function(o){var f=R(R({},i(o)),{},{position:u(o),deviceType:c(o)});e.pointerLeaveEvent(f),f.deviceType==="mouse"&&e.mouseLeaveEvent(f)},e.handlePointerDown=function(o){if(!(o.button>2||e.isPointerLocked()))switch(t.preventDefaultOnPointerDown&&le(o),o.target.hasPointerCapture(o.pointerId)&&o.target.releasePointerCapture(o.pointerId),t.container.setPointerCapture(o.pointerId),n.has(o.pointerId)&&ke("[RenderWindowInteractor] duplicate pointerId detected"),n.set(o.pointerId,{pointerId:o.pointerId,position:u(o)}),o.pointerType){case"pen":case"touch":e.handleTouchStart(o);break;case"mouse":default:e.handleMouseDown(o);break}},e.handlePointerUp=function(o){if(n.has(o.pointerId))switch(t.preventDefaultOnPointerUp&&le(o),n.delete(o.pointerId),t.container.releasePointerCapture(o.pointerId),o.pointerType){case"pen":case"touch":e.handleTouchEnd(o);break;case"mouse":default:e.handleMouseUp(o);break}},e.handlePointerCancel=function(o){if(n.has(o.pointerId))switch(n.delete(o.pointerId),o.pointerType){case"pen":case"touch":e.handleTouchEnd(o);break;case"mouse":default:e.handleMouseUp(o);break}},e.handlePointerMove=function(o){if(n.has(o.pointerId)){var f=n.get(o.pointerId);f.position=u(o)}switch(o.pointerType){case"pen":case"touch":e.handleTouchMove(o);break;case"mouse":default:e.handleMouseMove(o);break}},e.handleMouseDown=function(o){var f=R(R({},i(o)),{},{position:u(o),deviceType:c(o)});switch(o.button){case 0:e.leftButtonPressEvent(f);break;case 1:e.middleButtonPressEvent(f);break;case 2:e.rightButtonPressEvent(f);break;default:Re("Unknown mouse button pressed: ".concat(o.button));break}},e.requestPointerLock=function(){t.container&&t.container.requestPointerLock()},e.exitPointerLock=function(){var o,f;return(o=(f=document).exitPointerLock)===null||o===void 0?void 0:o.call(f)},e.isPointerLocked=function(){return!!t.container&&document.pointerLockElement===t.container},e.handlePointerLockChange=function(){e.isPointerLocked()?e.startPointerLockEvent():e.endPointerLockEvent()};function h(){t._view&&t.enabled&&t.enableRender&&(t.inRender=!0,t._view.traverseAllPasses(),t.inRender=!1),e.invokeRenderEvent()}e.requestAnimation=function(o){if(o===void 0){Re("undefined requester, can not start animating");return}if(r.has(o)){ke("requester is already registered for animating");return}r.add(o),!t.animationRequest&&r.size===1&&!t.xrAnimation&&(t._animationStartTime=Date.now(),t._animationFrameCount=0,t.animationRequest=requestAnimationFrame(e.handleAnimation),e.startAnimationEvent())},e.extendAnimation=function(o){var f=Date.now()+o;t._animationExtendedEnd=Math.max(t._animationExtendedEnd,f),!t.animationRequest&&r.size===0&&!t.xrAnimation&&(t._animationStartTime=Date.now(),t._animationFrameCount=0,t.animationRequest=requestAnimationFrame(e.handleAnimation),e.startAnimationEvent())},e.isAnimating=function(){return t.xrAnimation||t.animationRequest!==null},e.cancelAnimation=function(o){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r.has(o)){if(!f){var y=o&&o.getClassName?o.getClassName():o;ke("".concat(y," did not request an animation"))}return}r.delete(o),t.animationRequest&&r.size===0&&Date.now()>t._animationExtendedEnd&&(cancelAnimationFrame(t.animationRequest),t.animationRequest=null,e.endAnimationEvent(),e.render())},e.switchToXRAnimation=function(){t.animationRequest&&(cancelAnimationFrame(t.animationRequest),t.animationRequest=null),t.xrAnimation=!0},e.returnFromXRAnimation=function(){t.xrAnimation=!1,r.size!==0&&(t.recentAnimationFrameRate=10,t.animationRequest=requestAnimationFrame(e.handleAnimation))},e.updateXRGamepads=function(o,f,y){o.inputSources.forEach(function(d){var m=d.gripSpace==null?null:f.getPose(d.gripSpace,y),w=d.gamepad,T=d.handedness;if(w){w.index in t.lastGamepadValues||(t.lastGamepadValues[w.index]={left:{buttons:{}},right:{buttons:{}},none:{buttons:{}}});for(var g=0;g<w.buttons.length;++g)g in t.lastGamepadValues[w.index][T].buttons||(t.lastGamepadValues[w.index][T].buttons[g]=!1),t.lastGamepadValues[w.index][T].buttons[g]!==w.buttons[g].pressed&&m!=null&&(e.button3DEvent({gamepad:w,position:m.transform.position,orientation:m.transform.orientation,pressed:w.buttons[g].pressed,device:d.handedness==="left"?Te.LeftController:Te.RightController,input:Ae[w.mapping]&&Ae[w.mapping][g]?Ae[w.mapping][g]:A.Trigger}),t.lastGamepadValues[w.index][T].buttons[g]=w.buttons[g].pressed),t.lastGamepadValues[w.index][T].buttons[g]&&m!=null&&e.move3DEvent({gamepad:w,position:m.transform.position,orientation:m.transform.orientation,device:d.handedness==="left"?Te.LeftController:Te.RightController})}})},e.handleMouseMove=function(o){var f=R(R({},i(o)),{},{position:u(o),deviceType:c(o)});t.moveTimeoutID===0?e.startMouseMoveEvent(f):(e.mouseMoveEvent(f),clearTimeout(t.moveTimeoutID)),t.moveTimeoutID=setTimeout(function(){e.endMouseMoveEvent(),t.moveTimeoutID=0},200)},e.handleAnimation=function(){var o=Date.now();t._animationFrameCount++,o-t._animationStartTime>1e3&&t._animationFrameCount>1&&(t.recentAnimationFrameRate=1e3*(t._animationFrameCount-1)/(o-t._animationStartTime),t.lastFrameTime=1/t.recentAnimationFrameRate,e.animationFrameRateUpdateEvent(),t._animationStartTime=o,t._animationFrameCount=1),e.animationEvent(),h(),r.size>0||Date.now()<t._animationExtendedEnd?t.animationRequest=requestAnimationFrame(e.handleAnimation):(cancelAnimationFrame(t.animationRequest),t.animationRequest=null,e.endAnimationEvent(),e.render())},e.handleWheel=function(o){le(o);var f=R(R(R({},na(o)),i(o)),{},{position:u(o),deviceType:c(o)});t.wheelTimeoutID===0&&(Math.abs(f.spinY)>=.3?a=Math.abs(f.spinY):a=1),f.spinY/=a,t.wheelTimeoutID===0?(e.startMouseWheelEvent(f),e.mouseWheelEvent(f)):(e.mouseWheelEvent(f),clearTimeout(t.wheelTimeoutID)),t.mouseScrollDebounceByPass?(e.extendAnimation(600),e.endMouseWheelEvent(),t.wheelTimeoutID=0):t.wheelTimeoutID=setTimeout(function(){e.extendAnimation(600),e.endMouseWheelEvent(),t.wheelTimeoutID=0},200)},e.handleMouseUp=function(o){var f=R(R({},i(o)),{},{position:u(o),deviceType:c(o)});switch(o.button){case 0:e.leftButtonReleaseEvent(f);break;case 1:e.middleButtonReleaseEvent(f);break;case 2:e.rightButtonReleaseEvent(f);break;default:Re("Unknown mouse button released: ".concat(o.button));break}},e.handleTouchStart=function(o){var f=se(n.values());if(t.recognizeGestures&&f.length>1){var y=Me(n);if(f.length===2){var d=R(R({},i(oe)),{},{position:f[0].position,deviceType:c(o)});e.leftButtonReleaseEvent(d)}e.recognizeGesture("TouchStart",y)}else if(f.length===1){var m=R(R({},i(oe)),{},{position:u(o),deviceType:c(o)});e.leftButtonPressEvent(m)}},e.handleTouchMove=function(o){var f=se(n.values());if(t.recognizeGestures&&f.length>1){var y=Me(n);e.recognizeGesture("TouchMove",y)}else if(f.length===1){var d=R(R({},i(oe)),{},{position:f[0].position,deviceType:c(o)});e.mouseMoveEvent(d)}},e.handleTouchEnd=function(o){var f=se(n.values());if(t.recognizeGestures)if(f.length===0){var y=R(R({},i(oe)),{},{position:u(o),deviceType:c(o)});e.leftButtonReleaseEvent(y)}else if(f.length===1){var d=Me(n);e.recognizeGesture("TouchEnd",d);var m=R(R({},i(oe)),{},{position:f[0].position,deviceType:c(o)});e.leftButtonPressEvent(m)}else{var w=Me(n);e.recognizeGesture("TouchMove",w)}else if(f.length===1){var T=R(R({},i(oe)),{},{position:f[0].position,deviceType:c(o)});e.leftButtonReleaseEvent(T)}},e.setView=function(o){t._view!==o&&(t._view=o,t._view.getRenderable().setInteractor(e),e.modified())},e.getFirstRenderer=function(){var o,f,y;return(o=t._view)===null||o===void 0||(f=o.getRenderable())===null||f===void 0||(y=f.getRenderersByReference())===null||y===void 0?void 0:y[0]},e.findPokedRenderer=function(){var o,f,y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!t._view)return null;var m=(o=t._view)===null||o===void 0||(f=o.getRenderable())===null||f===void 0?void 0:f.getRenderers();if(!m||m.length===0)return null;m.sort(function(O,b){return O.getLayer()-b.getLayer()});for(var w=null,T=null,g=null,S=m.length;S--;){var E=m[S];if(t._view.isInViewport(y,d,E)&&E.getInteractive()){g=E;break}w===null&&E.getInteractive()&&(w=E),T===null&&t._view.isInViewport(y,d,E)&&(T=E)}return g===null&&(g=w),g===null&&(g=T),g==null&&(g=m[0]),g},e.render=function(){!e.isAnimating()&&!t.inRender&&h()},Je.forEach(function(o){var f=o.charAt(0).toLowerCase()+o.slice(1);e["".concat(f,"Event")]=function(y){if(t.enabled){var d=e.getCurrentRenderer();if(!d){ra(`
          Can not forward events without a current renderer on the interactor.
        `);return}var m=R({type:o,pokedRenderer:t.currentRenderer,firstRenderer:e.getFirstRenderer()},y);e["invoke".concat(o)](m)}}}),e.recognizeGesture=function(o,f){if(!(Object.keys(f).length>2)){if(t.startingEventPositions||(t.startingEventPositions={}),o==="TouchStart"){Object.keys(f).forEach(function(ve){t.startingEventPositions[ve]=f[ve]}),t.currentGesture="Start";return}if(o==="TouchEnd"){t.currentGesture==="Pinch"&&(e.render(),e.endPinchEvent()),t.currentGesture==="Rotate"&&(e.render(),e.endRotateEvent()),t.currentGesture==="Pan"&&(e.render(),e.endPanEvent()),t.currentGesture="Start",t.startingEventPositions={};return}var y=0,d=[],m=[];Object.keys(f).forEach(function(ve){d[y]=f[ve],m[y]=t.startingEventPositions[ve],y++});var w=Math.sqrt((m[0].x-m[1].x)*(m[0].x-m[1].x)+(m[0].y-m[1].y)*(m[0].y-m[1].y)),T=Math.sqrt((d[0].x-d[1].x)*(d[0].x-d[1].x)+(d[0].y-d[1].y)*(d[0].y-d[1].y)),g=Qt(Math.atan2(m[1].y-m[0].y,m[1].x-m[0].x)),S=Qt(Math.atan2(d[1].y-d[0].y,d[1].x-d[0].x)),E=S-g;S=S+180>=360?S-180:S+180,g=g+180>=360?g-180:g+180,Math.abs(S-g)<Math.abs(E)&&(E=S-g);var O=[];if(O[0]=(d[0].x-m[0].x+d[1].x-m[1].x)/2,O[1]=(d[0].y-m[0].y+d[1].y-m[1].y)/2,o==="TouchMove")if(t.currentGesture==="Start"){var b=.01*Math.sqrt(t.container.clientWidth*t.container.clientWidth+t.container.clientHeight*t.container.clientHeight);b<15&&(b=15);var M=Math.abs(T-w),_=T*3.1415926*Math.abs(E)/360,L=Math.sqrt(O[0]*O[0]+O[1]*O[1]);if(M>b&&M>_&&M>L){t.currentGesture="Pinch";var W={scale:1,touches:f};e.startPinchEvent(W)}else if(_>b&&_>L){t.currentGesture="Rotate";var $={rotation:0,touches:f};e.startRotateEvent($)}else if(L>b){t.currentGesture="Pan";var N={translation:[0,0],touches:f};e.startPanEvent(N)}}else{if(t.currentGesture==="Rotate"){var ae={rotation:E,touches:f};e.rotateEvent(ae)}if(t.currentGesture==="Pinch"){var J={scale:T/w,touches:f};e.pinchEvent(J)}if(t.currentGesture==="Pan"){var Ca={translation:O,touches:f};e.panEvent(Ca)}}}},e.handleVisibilityChange=function(){t._animationStartTime=Date.now(),t._animationFrameCount=0},e.setCurrentRenderer=function(o){t._forcedRenderer=!!o,t.currentRenderer=o};var p=e.delete;e.delete=function(){for(;r.size;)e.cancelAnimation(r.values().next().value);typeof document.hidden<"u"&&document.removeEventListener("visibilitychange",e.handleVisibilityChange),t.container&&e.unbindEvents(),p()},typeof document.hidden<"u"&&document.addEventListener("visibilitychange",e.handleVisibilityChange,!1)}var aa={renderWindow:null,interactorStyle:null,picker:null,pickingManager:null,initialized:!1,enabled:!1,enableRender:!0,currentRenderer:null,lightFollowCamera:!0,desiredUpdateRate:30,stillUpdateRate:2,container:null,recognizeGestures:!0,currentGesture:"Start",animationRequest:null,lastFrameTime:.1,recentAnimationFrameRate:10,wheelTimeoutID:0,moveTimeoutID:0,lastGamepadValues:{},preventDefaultOnPointerDown:!1,preventDefaultOnPointerUp:!1,mouseScrollDebounceByPass:!1};function en(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,aa,r),k.obj(e,t),t._animationExtendedEnd=0,k.event(e,t,"RenderEvent"),Je.forEach(function(n){return k.event(e,t,n)}),k.get(e,t,["initialized","container","interactorStyle","lastFrameTime","recentAnimationFrameRate","_view"]),k.setGet(e,t,["lightFollowCamera","enabled","enableRender","recognizeGestures","desiredUpdateRate","stillUpdateRate","picker","preventDefaultOnPointerDown","preventDefaultOnPointerUp","mouseScrollDebounceByPass"]),k.moveToProtected(e,t,["view"]),oa(e,t)}var ia=k.newInstance(en,"vtkRenderWindowInteractor"),tn=R({newInstance:ia,extend:en,handledEvents:Je},Ye);function nn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nn(Object(r),!0).forEach(function(n){V(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nn(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var sa=k.vtkErrorMacro,ua=k.VOID;function ca(e,t,r,n){var a=e.getRenderWindow().getViews()[0];return a.worldToDisplay(t,r,n,e)}function fa(e,t,r,n){var a=e.getRenderWindow().getViews()[0];return a.displayToWorld(t,r,n,e)}var la={computeWorldToDisplay:ca,computeDisplayToWorld:fa};function ha(e,t){t.classHierarchy.push("vtkInteractorObserver");var r=rn({},e);function n(){for(;t.subscribedEvents.length;)t.subscribedEvents.pop().unsubscribe()}function a(){tn.handledEvents.forEach(function(l){e["handle".concat(l)]&&t.subscribedEvents.push(t._interactor["on".concat(l)](function(v){return t.processEvents?e["handle".concat(l)](v):ua},t.priority))})}e.setInteractor=function(l){l!==t._interactor&&(n(),t._interactor=l,l&&t.enabled&&a(),e.modified())},e.setEnabled=function(l){l!==t.enabled&&(n(),l&&(t._interactor?a():sa(`
          The interactor must be set before subscribing to events
        `)),t.enabled=l,e.modified())},e.computeDisplayToWorld=function(l,v,u,i){return l?t._interactor.getView().displayToWorld(v,u,i,l):null},e.computeWorldToDisplay=function(l,v,u,i){return l?t._interactor.getView().worldToDisplay(v,u,i,l):null},e.setPriority=function(l){var v=r.setPriority(l);v&&t._interactor&&(n(),a())}}var pa={enabled:!0,priority:0,processEvents:!0,subscribedEvents:[]};function on(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,pa,r),k.obj(e,t),k.event(e,t,"InteractionEvent"),k.event(e,t,"StartInteractionEvent"),k.event(e,t,"EndInteractionEvent"),k.get(e,t,["_interactor","enabled"]),k.setGet(e,t,["priority","processEvents"]),k.moveToProtected(e,t,["interactor"]),ha(e,t)}var va=k.newInstance(on,"vtkInteractorObserver"),ya=rn({newInstance:va,extend:on},la),ga={IS_START:0,IS_NONE:0,IS_ROTATE:1,IS_PAN:2,IS_SPIN:3,IS_DOLLY:4,IS_CAMERA_POSE:11,IS_WINDOW_LEVEL:1024,IS_SLICE:1025},an={States:ga};function sn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function da(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sn(Object(r),!0).forEach(function(n){V(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sn(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var G=an.States,Ze={Rotate:G.IS_ROTATE,Pan:G.IS_PAN,Spin:G.IS_SPIN,Dolly:G.IS_DOLLY,CameraPose:G.IS_CAMERA_POSE,WindowLevel:G.IS_WINDOW_LEVEL,Slice:G.IS_SLICE};function ma(e,t){t.classHierarchy.push("vtkInteractorStyle"),Object.keys(Ze).forEach(function(r){k.event(e,t,"Start".concat(r,"Event")),e["start".concat(r)]=function(){t.state===G.IS_NONE&&(t.state=Ze[r],t._interactor.requestAnimation(e),e.invokeStartInteractionEvent({type:"StartInteractionEvent"}),e["invokeStart".concat(r,"Event")]({type:"Start".concat(r,"Event")}))},k.event(e,t,"End".concat(r,"Event")),e["end".concat(r)]=function(){t.state===Ze[r]&&(t.state=G.IS_NONE,t._interactor.cancelAnimation(e),e.invokeEndInteractionEvent({type:"EndInteractionEvent"}),e["invokeEnd".concat(r,"Event")]({type:"End".concat(r,"Event")}),t._interactor.render())}}),e.handleKeyPress=function(r){var n=t._interactor,a=null;switch(r.key){case"r":case"R":r.pokedRenderer.resetCamera(),n.render();break;case"w":case"W":a=r.pokedRenderer.getActors(),a.forEach(function(l){var v=l.getProperty();v.setRepresentationToWireframe&&v.setRepresentationToWireframe()}),n.render();break;case"s":case"S":a=r.pokedRenderer.getActors(),a.forEach(function(l){var v=l.getProperty();v.setRepresentationToSurface&&v.setRepresentationToSurface()}),n.render();break;case"v":case"V":a=r.pokedRenderer.getActors(),a.forEach(function(l){var v=l.getProperty();v.setRepresentationToPoints&&v.setRepresentationToPoints()}),n.render();break}}}var wa={state:G.IS_NONE,handleObservers:1,autoAdjustCameraClippingRange:1};function un(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,wa,r),ya.extend(e,t,r),ma(e,t)}var Sa=k.newInstance(un,"vtkInteractorStyle"),Ea=da({newInstance:Sa,extend:un},an);const he={type:"StartInteractionEvent"},cn={type:"InteractionEvent"},pe={type:"EndInteractionEvent"};function Oa(e,t){t.classHierarchy.push("vtkInteractorStyleRemoteMouse");function r(n){const{buttonLeft:a,buttonMiddle:l,buttonRight:v}=t,u=n.shiftKey?1:0,i=n.controlKey?1:0,s=n.altKey?1:0,c=n.metaKey?1:0,h=a||l||v?"down":"up";let{x:p,y:o}=n.position;return{action:h,x:p,y:o,buttonLeft:a,buttonMiddle:l,buttonRight:v,shiftKey:u,altKey:s,ctrlKey:i,metaKey:c,...t.remoteEventAddOn}}e.handleLeftButtonPress=n=>{t.previousPosition=n.position,t.buttonLeft=1,e.onButtonDown(1,n)},e.handleMiddleButtonPress=n=>{t.previousPosition=n.position,t.buttonMiddle=1,e.onButtonDown(2,n)},e.handleRightButtonPress=n=>{t.previousPosition=n.position,t.buttonRight=1,e.onButtonDown(3,n)},e.handleLeftButtonRelease=n=>{t.buttonLeft=0,e.onButtonUp(1,n)},e.handleMiddleButtonRelease=n=>{t.buttonMiddle=0,e.onButtonUp(2,n)},e.handleRightButtonRelease=n=>{t.buttonRight=0,e.onButtonUp(3,n)},e.onButtonDown=(n,a)=>{e.invokeStartInteractionEvent(he);let l="";n==1?l="LeftButtonPress":n==2?l="MiddleButtonPress":n==3&&(l="RightButtonPress"),e.invokeRemoteMouseEvent({type:l,...r(a)})},e.onButtonUp=(n,a)=>{let l="";n==1?l="LeftButtonRelease":n==2?l="MiddleButtonRelease":n==3&&(l="RightButtonRelease"),e.invokeRemoteMouseEvent({type:l,...r(a)}),e.invokeEndInteractionEvent(pe)},e.handleStartMouseWheel=n=>{e.invokeStartInteractionEvent(he),e.invokeRemoteWheelEvent({type:"StartMouseWheel",...r(n),spinY:n.spinY})},e.handleMouseWheel=n=>{let a=!0;if(t.wheelThrottleDelay){const l=Date.now();a=t.wheelThrottleDelay<l-t.wheelLastThrottleTime,a&&(t.wheelLastThrottleTime=l)}a&&(e.invokeRemoteWheelEvent({type:"MouseWheel",...r(n),spinY:n.spinY}),e.invokeInteractionEvent(cn))},e.handleEndMouseWheel=()=>{e.invokeRemoteWheelEvent({type:"EndMouseWheel",...t.remoteEventAddOn}),e.invokeEndInteractionEvent(pe)},e.handleMouseMove=n=>{const a=Date.now();t.throttleDelay<a-t.lastThrottleTime&&(t.sendMouseMove||t.buttonLeft||t.buttonMiddle||t.buttonRight)&&(t.lastThrottleTime=a,e.invokeRemoteMouseEvent({type:"MouseMove",...r(n)})),e.invokeInteractionEvent(cn)},e.handleKeyPress=()=>{},e.handleStartPinch=n=>{e.startDolly();const{scale:a}=n;e.invokeStartInteractionEvent(he),e.invokeRemoteGestureEvent({type:"StartPinch",scale:a,...t.remoteEventAddOn})},e.handlePinch=n=>{const{scale:a}=n;e.invokeRemoteGestureEvent({type:"Pinch",scale:a,...t.remoteEventAddOn})},e.handleEndPinch=()=>{e.endDolly(),e.invokeRemoteGestureEvent({type:"EndPinch",...t.remoteEventAddOn}),e.invokeEndInteractionEvent(pe)},e.handleStartRotate=n=>{e.startRotate();const{rotation:a}=n;e.invokeStartInteractionEvent(he),e.invokeRemoteGestureEvent({type:"StartRotate",rotation:a,...t.remoteEventAddOn})},e.handleRotate=n=>{const{rotation:a}=n;e.invokeRemoteGestureEvent({type:"Rotate",rotation:a,...t.remoteEventAddOn})},e.handleEndRotate=()=>{e.endRotate(),e.invokeRemoteGestureEvent({type:"EndRotate",...t.remoteEventAddOn}),e.invokeEndInteractionEvent(pe)},e.handleStartPan=n=>{e.startPan();const{translation:a}=n;e.invokeStartInteractionEvent(he),e.invokeRemoteGestureEvent({type:"StartPan",translation:a,...t.remoteEventAddOn})},e.handlePan=n=>{const{translation:a}=n;e.invokeRemoteGestureEvent({type:"Pan",translation:a,...t.remoteEventAddOn})},e.handleEndPan=()=>{e.endPan(),e.invokeRemoteGestureEvent({type:"EndPan",...t.remoteEventAddOn}),e.invokeEndInteractionEvent(pe)},e.handleKeyPress=n=>{e.invokeRemoteKeyEvent({type:"keyPress",...n})},e.handleKeyDown=n=>{e.invokeRemoteKeyEvent({type:"keyDown",...n})},e.handleKeyUp=n=>{e.invokeRemoteKeyEvent({type:"keyUp",...n})}}const ba={buttonLeft:0,buttonMiddle:0,buttonRight:0,sendMouseMove:!1,throttleDelay:33.3,lastThrottleTime:0,wheelThrottleDelay:0,wheelLastThrottleTime:0};function fn(e,t,r={}){Object.assign(t,ba,r),Ea.extend(e,t,r),k.setGet(e,t,["sendMouseMove","remoteEventAddOn","throttleDelay","wheelThrottleDelay"]),k.event(e,t,"RemoteMouseEvent"),k.event(e,t,"RemoteWheelEvent"),k.event(e,t,"RemoteGestureEvent"),k.event(e,t,"RemoteKeyEvent"),Oa(e,t)}const xa={newInstance:k.newInstance(fn,"vtkInteractorStyleRemoteMouse"),extend:fn},{inject:Ta,provide:ka,ref:ln,toRefs:Ra,onMounted:Ma,onBeforeUnmount:Da}=window.Vue,hn=Promise.resolve(!0),pn={DisplayArea:Tn,StatisticsDisplay:Mn,ImageDisplayArea:Qe,RemoteControlledArea:{props:{name:{type:String,default:"default"},origin:{type:String,default:"anonymous"},display:{type:String,default:"image"},sendMouseMove:{type:Boolean,default:!1}},setup(e){const t=ln(null),r=ln(hn),n=Ta("trame");let a=!0,l=null,v=0,u=[0,0],i={w:10,h:10,p:window.devicePixelRatio},s=!0,c=hn,h=0;function p(g){return g.preventDefault(),{x:g.clientX-u[0],y:i.h-g.clientY+u[1],z:0}}const o=tn.newInstance({_getScreenEventPositionFor:p,currentRenderer:1}),f=xa.newInstance();o.setInteractorStyle(f),f.setSendMouseMove(e.sendMouseMove),f.onRemoteMouseEvent(g=>{y(Object.assign({w:i.w,h:i.h},g))}),f.onRemoteWheelEvent(g=>{y(Object.assign({w:i.w,h:i.h},g))}),f.onRemoteGestureEvent(g=>{y(Object.assign({w:i.w,h:i.h},g))}),f.onRemoteKeyEvent(g=>{y(Object.assign({w:i.w,h:i.h},g))}),f.onStartInteractionEvent(g=>{y(g)}),f.onEndInteractionEvent(g=>{y(g)});function y(g){n&&(a?(a=!1,l=g,r.value=n.client.getConnection().getSession().call("trame.rca.event",[e.name,e.origin,l]),c.finally(d)):l.type!==g.type&&(v=0,n.client.getConnection().getSession().call("trame.rca.event",[e.name,e.origin,l]),n.client.getConnection().getSession().call("trame.rca.event",[e.name,e.origin,g]),l=g))}function d(){a=!0,v&&(v=0,y(l))}function m(){s=!0,h&&(h=0,T())}const w=new ResizeObserver(()=>{if(!t.value)return;const g=t.value.getBoundingClientRect(),{top:S,left:E}=g;i.w=g.width,i.h=g.height,i.p=window.devicePixelRatio,u=[E,S],T()});function T(g){n&&(s?(s=!1,g?c=n.client.getConnection().getSession().call("trame.rca.size",[e.name,e.origin,{...i,...g}]):c=n.client.getConnection().getSession().call("trame.rca.size",[e.name,e.origin,i]),c.finally(m)):h++)}return ka("rcaPushSize",T),Ma(()=>{w.observe(t.value),o.initialize(),o.bindEvents(t.value)}),Da(()=>{w.unobserve(t.value),o.unbindEvents(t.value)}),{rootElem:t,...Ra(e)}},template:`
    <div ref="rootElem" style="margin: 0; padding: 0; position: relative; width: 100%; height: 100%;">
      <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
        <display-area :display="display" :name="name" :origin="origin" />
        <slot></slot>
      </div>
    </div>
  `},MediaSourceDisplayArea:Ie,VideoDecoderDisplayArea:et,RawImageDisplayArea:tt};function ja(e){Object.keys(pn).forEach(t=>{e.component(t,pn[t])})}Z.install=ja,Object.defineProperty(Z,Symbol.toStringTag,{value:"Module"})});
