openapi: 3.0.1
info:
  title: API Postavok
  version: ""
security:
- HeaderApiKey: []

tags:
  - name: Informacia dla formirovania postavok
    description: Poluhenie informacii dla formirovania postavok na sklady Wildberries

paths:
  /api/v1/acceptance/coefficients:
    servers:
      - url: https://supplies-api.wildberries.ru
    get:
      security:
        - HeaderApiKey: []
      tags: 
        -  Informacia dla formirovania postavok
      summary: Koefficienty priemki
      description: >
        Vozvrahaet koefficienty priemki dla konkretnyh skladov na blihaihie 14 dnei.
        <br>Maksimum 6 zaprosov v minutu
      parameters:
      - name: warehouseIDs
        in: query
        description: ID skladov.<br>Po umolhaniu vozvrahautsa dannye po vsem skladam
        schema:
          type: string
        example: 507,117501
      responses:
        "200":
          description: Uspehno
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/models.AcceptanceCoefficient'
              examples:
                ResponseCoefficients:
                  $ref: '#/components/examples/ResponseCoefficients'
        "400":
          description: Nekorrektnyi zapros
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/models.ErrorModel'
              examples:
                BadWarehouseIDsParam:
                  $ref: '#/components/examples/Response400Coefficients'
        401:
          $ref: "../../../../openapi/ru/responses/401.yaml"
        '403':
          description: Dostup zaprehen
        "404":
          description: Adres ne naiden
        429:
          $ref: "../../../../openapi/ru/responses/429.yaml"
        "500":
          description: Vnutrennaa ohibka servera
  /api/v1/acceptance/options:
    servers:
      - url: https://supplies-api.wildberries.ru
    post:
      security:
        - HeaderApiKey: []
      tags: 
        -  Informacia dla formirovania postavok
      summary: Opcii priemki
      description: >
        Vozvrahaet informaciu o tom, kakie sklady i tipy upakovki dostupny dla postavki. Spisok skladov opredelaetsa po barkodu tovara i ego kolihestvu.
        <br>Maksimum 30 zaprosov v minutu
      requestBody:
        content:
          application/json:
            schema:
              type: array
              maxItems: 5000
              items:
                $ref: '#/components/schemas/models.Good'
            examples:
              RequestOptions:
                $ref: '#/components/examples/RequestOptions'
        required: true
      responses:
        "200":
          description: Uspehno
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/models.OptionsResultModel'
              examples:
                Response:
                  $ref: '#/components/examples/OptionsResponse'
        401:
          $ref: "../../../../openapi/ru/responses/401.yaml"
        '403':
          description: Dostup zaprehen
        "404":
          description: Adres ne naiden
        429:
          $ref: "../../../../openapi/ru/responses/429.yaml"
        "500":
          description: Vnutrennaa ohibka servera
      x-codegen-request-body-name: goods
  /api/v1/warehouses:
    servers:
      - url: https://supplies-api.wildberries.ru
    get:
      security:
        - HeaderApiKey: []
      tags: 
        -  Informacia dla formirovania postavok
      summary: Spisok skladov
      description: >
        Vozvrahaet spisok skladov Wildberries.
        <br>Maksimum 6 zaprosov v minutu
      responses:
        "200":
          description: Uspehno
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/models.WarehousesResultItems'
        401:
          $ref: "../../../../openapi/ru/responses/401.yaml"
        '403':
          description: Dostup zaprehen
        "404":
          description: Adres ne naiden
        429:
          $ref: "../../../../openapi/ru/responses/429.yaml"
        "500":
          description: Vnutrennaa ohibka servera
components:
  securitySchemes:
    HeaderApiKey:
      type: apiKey
      name: Authorization
      in: header
  schemas:
    models.AcceptanceCoefficient:
      type: object
      properties:
        date:
          type: string
          description: Data nahala deistvia koefficienta
        coefficient:
          type: number
          description: |
            Koefficient priemki:
              - `-1` — postavka nedostupna
              - `0` — besplatnaa postavka
              - ot `1` — mnohitel stoimosti priemki
        warehouseID:
          type: integer
          description: ID sklada. Po nemu mohno poluhit [informaciu o sklade](./#tag/Informaciya-dlya-formirovaniya-postavok/paths/~1api~1v1~1warehouses/get)
        warehouseName:
          type: string
          description: Nazvanie sklada
        boxTypeName:
          type: string 
          description: >
              Tip postavki:
                - `Koroba`
                - `Monopallety`
                - `Superseif`
                - `QR-postavka s korobami`
        boxTypeID:
          type: integer
          description: >
              ID tipa postavki:
                - `2` — Koroba
                - `5` — Monopallety
                - `6` — Superseif
              <br>Dla tipa postavki **QR-postavka s korobami** pole ne vozvrahaetsa
    models.WarehousesResultItems:
      type: object
      properties:
        ID:
          type: integer
          description: ID sklada
        name:
          type: string
          description: Nazvanie sklada
        address:
          type: string
          description: Adres sklada
        workTime:
          type: string
          description: Rehim raboty sklada       
        acceptsQr:
          type: boolean
          description: |
            Prinimaet li sklad QR-postavki:
            - `true` — da
            - `false` — net
      example: {"ID":210515,"name":"Vehki","address":"Lipkinskoe hosse, 2-i kilometr, vl1s1, poselok Vehki, gorodskoi okrug Mytihi, Moskovskaa oblast","workTime":"24/7","acceptsQR":false}
    models.Good:
      type: object
      properties:
        quantity:
          type: integer
          description: >
            Summarnoe kolihestvo tovarov, planiruemyh dla postavki. Maksimum 999999
          minimum: 1
          maximum: 999999
        barcode:
          type: string
          description: Barkod iz kartohki tovara
    models.ErrorModel:
      type: object
      properties:
        status:
          type: integer
          description: HTTP status-kod
        title:
          type: string
          description: ID ohibki
        detail:
          type: string
          description: Opisanie ohibki
        requestId:
          type: string
          description: ID zaprosa
        origin:
          type: string
          description: Servis, vernuvhii ohibku
    models.OptionsResultModel: 
      type: object
      properties:
        result:
          type: array
          items:
            type: object 
            properties: 
              barcode:
                type: string
                description: Barkod iz kartohki tovara
              error:
                type: object
                description: Dannye ohibki. Pri nalihii
                properties:
                  title:
                    type: string
                    description: ID ohibki
                  detail: 
                    type: string
                    description: Opisanie ohibki
              isError: 
                type: boolean
                description: |
                  Nalihie ohibki:
                    - `true` — ohibka est
                    - Pola net — ohibka otsutstvuet   
              warehouses:
                type: array
                nullable: true
                description: Spisok skladov. Pri nalihii ohibki budet `null`
                items: 
                  type: object
                  properties: 
                    warehouseID:
                      type: integer
                      description: ID sklada. Po nemu mohno poluhit [informaciu o sklade](./#tag/Informaciya-dlya-formirovaniya-postavok/paths/~1api~1v1~1warehouses/get)
                    canBox:
                      type: boolean
                      description: |
                        Tip upakovki **Korob**:
                          - `true` — dostupen
                          - `false` — nedostupen
                    canMonopallet:
                      type: boolean
                      description: |
                        Tip upakovki **Monopalleta**:
                          - `true` — dostupen
                          - `false` — nedostupen
                    canSupersafe:
                      type: boolean
                      description: |
                        Tip upakovki **Superseif**:
                          - `true` — dostupen
                          - `false` — nedostupen
        requestId:
          type: string
          description: ID zaprosa pri nalihii ohibok
  examples:
    RequestOptions:
      value: [{"quantity":1,"barcode":"k"},{"quantity":7,"barcode":"1111111111"}]
    ResponseCoefficients:
      value: [{"date":"2024-04-11T00:00:00Z","coefficient":-1,"warehouseID":217081,"warehouseName":"Sc Bransk 2","boxTypeName":"Superseif","boxTypeID":6},{"date":"2024-04-11T00:00:00Z","coefficient":1,"warehouseID":204939,"warehouseName":"Astana","boxTypeName":"QR-postavka s korobami"}]
    Response400Coefficients:
      value: {"status":400,"title":"bad request","detail":"warehouseIDs param is incorrect","requestId":"2423423","origin":"supply-api"}
      description: Znahenie parametra `warehouseIDs` nekorrektno
    OptionsResponse:
      value: {"result":[{"barcode":"krrr","warehouses":null,"error":{"title":"barcode validation error","detail":"barcode krrr is not found"},"isError":true},{"barcode":"123456789","warehouses":[{"warehouseID":205349,"canBox":true,"canMonopallet":false,"canSupersafe":false},{"warehouseID":211622,"canBox":false,"canMonopallet":true,"canSupersafe":false},{"warehouseID":214951,"canBox":true,"canMonopallet":false,"canSupersafe":false},{"warehouseID":206319,"canBox":true,"canMonopallet":false,"canSupersafe":false}]}],"requestId":"kr53d2bRKYmkK2N6zaNKHs"}