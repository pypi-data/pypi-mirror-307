{% load i18n %}

<div id="modal-{{ form_id }}" class="modal {% block modal_form_class %}is-active{% endblock %}"
     hx-swap="outerHTML" 
     hx-target="#modal-{{ form_id }}"
     hx-on:delete="removeModal('modal-{{ form_id }}')"
     {% if blocking %}
        hx-indicator="#modal-{{ form_id }}-indicator"
        hx-disabled-elt="#modal-{{ form_id }}-background"
     {% endif %}
>
    <button id="modal-{{ form_id }}-background" class="modal-background" onclick="removeModal('modal-{{ form_id }}')" style="cursor: default"></button>
    <div class="modal-card">
        <header class="modal-card-head">
            <p class="modal-card-title">
                {{ title }}
            </p>
            <button class="delete filter-modal-close" aria-label="close" onclick="removeModal('modal-{{ form_id }}')"></button>
        </header>
        <section id="modal-content" class="modal-card-body">
            {% if form.is_saved is False %}
                {% include 'ui/partials/form_errors.html' %}
            {% endif %}
            {% block modal_content %}{% endblock %}
        </section>
        <footer class="modal-card-foot">
            {% block modal_footer %}
                <div class="buttons" style="width: 100%">
                    {% block modal_buttons %}
                        <button class="button is-success" type="submit" form="{{ form_id }}">
                            {% translate 'Save' %}
                        </button>
                        <button class="button" onclick="removeModal('modal-{{ form_id }}')">
                            {% translate 'Discard' %}
                        </button>
                    {% endblock %}
                </div>
            {% endblock %}
        </footer>
        {% if blocking %}
            <div id="modal-{{ form_id }}-indicator" class="htmx-indicator modal-request-overlay" style="position: absolute; inset: 0; background: rgba(47, 47, 62, 0.2)">
                <progress class="progress is-success" max="100" style="position: fixed; inset: 0; min-width: 300px; max-width: 20vw; margin: auto;"></progress>
            </div>
        {% endif %}
    </div>
</div>