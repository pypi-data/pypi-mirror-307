<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>{% block title %}{% trans quotenumber=bill.quote_number %}Quote #{{ quotenumber }}{% endtrans %}{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='bill.css') }}">
    {% if g.user_pref.bill_style %}<style>{{ g.user_pref.bill_style }}</style>{% endif %}
  </head>
  <body>
    <div class="persons logos">
      {% if g.user_pref.logo_url %}
        <img src="{{ g.user_pref.logo_url }}">
      {% else %}
        <div></div>
      {% endif %}
      {% if customer.logo_url %}
        <img src="{{ customer.logo_url }}">
      {% endif %}
    </div>
    {% block identifier %}
      <div class="warning">
        <h1>{% trans %}Draft{% endtrans %}</h1>
      </div>
      <div class="persons">
        <pre><b>{% trans %}From{% endtrans %}</b>
{{ bill.source or '' }}</pre>
        <pre><b>{% trans %}To{% endtrans %}</b>
{{ bill.recipient }}</pre>
      </div>
      <p>
        {% if None == bill.quote_number %}
          <b>{% trans %}Draft{% endtrans %}</b><br>
          {% trans date=bill.created_at.strftime("%Y-%m-%d") %}Generated {{ date }}{% endtrans %}
        {% else %}
          <b>{% trans quotenumber=bill.quote_number %}Quote #{{ quotenumber }}{% endtrans %}</b><br>
          {% trans date=bill.created_at.strftime("%Y-%m-%d") %}Issued {{ date }}{% endtrans %}
        {% endif %}
      </p>
    {% endblock %}
    <table>
      <thead>
        <tr>
          <th>{% trans %}Detail{% endtrans %}</th>
          <th>{% trans %}Price{% endtrans %}</th>
          <th>{% trans %}Qty{% endtrans %}</th>
          <th>{% trans %}Amount{% endtrans %}</th>
          <th>{% trans %}Tax{% endtrans %}</th>
          <th>{% trans %}Total{% endtrans %}</th>
        </tr>
      </thead>
      {% for bill_row in bill_rows %}
        <tr>
          <td>{{ bill_row.label }}</td>
          <td>{{ (bill_row.price / 100) | round(2, 'floor') }} {{ g.user_pref.currency or "" }}</td>
          <td>{{ bill_row.quantity }}</td>
          <td>{{ (bill_row.gross_amount / 100) | round(2, 'floor') }} {{ g.user_pref.currency or "" }}</td>
          <td>{{ bill_row.tax_rate }} %</td>
          <td>{{ ((bill_row.gross_amount + bill_row.tax_amount) / 100) | round(2, 'floor') }} {{ g.user_pref.currency or "" }}</td>
        </tr>
      {% endfor %}
      <tfoot>
        <tr>
          <td colspan="3"></td>
          <td>{{ (bill.gross_amount / 100) | round(2, 'floor') }} {{ g.user_pref.currency or "" }}</td>
          <td>{{ (bill.tax_amount / 100) | round(2, 'floor') }} {{ g.user_pref.currency or "" }}</td>
          <td>{{ (bill.amount / 100) | round(2, 'floor') }} {{ g.user_pref.currency or "" }}</td>
        </tr>
      </tfoot>
    </table>
    {% block mentions %}
      <p>{{ (bill.quote_mentions or '')|safe }}</p>
    {% endblock %}
  </body>
</html>
