{% from 'macros.html' import paginate %}

{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}{% trans %}Products{% endtrans %}{% endblock %}</h1>
  <a class="action" href="{{ url_for('product.create') }}">{% trans %}New{% endtrans %}</a>
{% endblock %}

{% block content %}
  <label for="filter-hidder">{% trans %}Show filters{% endtrans %}</label>
  <input type="checkbox" id="filter-hidder" class="hidder" {% if filtered %}checked{% endif %}>
  <form class="filters">
    <label for="label__ilike">{% trans %}Label{% endtrans %}</label>
    <input name="label__ilike" id="label__ilike" {% if filtered %}autofocus{% endif %}
      value="{{ request.args.get('label__ilike', '') }}">
    <div class="flex-align">
      <div class="form">
        <label for="price__price__ge">{% trans %}Price greater than{% endtrans %}</label>
        <input name="price__price__ge" id="price__price__ge" type="number" step="0.01" min="0"
          value="{{ request.args.get('price__price__ge', '') }}">
      </div>
      <div class="form">
        <label for="price__price__le">{% trans %}Price lower than{% endtrans %}</label>
        <input name="price__price__le" id="price__price__le" type="number" step="0.01" min="0"
          value="{{ request.args.get('price__price__le', '') }}">
      </div>
    </div>
    <div class="flex-align">
      <div class="form">
      <label for="tax_rate__ge">{% trans %}Tax rate greater than{% endtrans %}</label>
      <input name="tax_rate__ge" id="tax_rate__ge" type="number" step="0.01" max="100" min="0"
        value="{{ request.args.get('tax_rate__ge', '') }}">
      </div>
      <div class="form">
      <label for="tax_rate__le">{% trans %}Tax rate lower than{% endtrans %}</label>
      <input name="tax_rate__le" id="tax_rate__le" type="number" step="0.01" max="100" min="0"
        value="{{ request.args.get('tax_rate__le', '') }}">
      </div>
    </div>
    <div class="actions">
      <input type="submit" value="{% trans %}Filter{% endtrans %}">
      <a href="{{ url_for(".index") }}">{% trans %}Reset{% endtrans %}</a>
    </div>
  </form>
  <div class="table-cap">
    <table class="index">
      <thead>
        <tr>
          <th>{% trans %}Label{% endtrans %}</th>
          <th>{% trans %}Price{% endtrans %}</th>
          <th>{% trans %}Tax rate{% endtrans %}</th>
          <th>{% trans %}Action{% endtrans %}</th>
        </tr>
      </thead>
      <tbody>
        {% for product in products %}
          <tr>
            <td>{{ product.label }}</td>
            <td>{{ product.price / 100 }}</td>
            <td>{{ product.tax_rate }}</td>
            <td>
              <a href="{{ url_for('product.update', id=product.id) }}">{% trans %}Edit{% endtrans %}</a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {{ paginate(pagination) if pagination.max > 1 }}
{% endblock %}
