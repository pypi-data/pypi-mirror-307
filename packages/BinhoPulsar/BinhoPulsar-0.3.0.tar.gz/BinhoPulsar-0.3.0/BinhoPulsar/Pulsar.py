"""
Binho Pulsar Python package

This Python package is developed to control the new Pulsar USB Host adapter.
The new Binho Pulsar device is an USB HID device that is controlled using a set
of USB commands that are transferred over USB HID Interrupt transfers.
"""
from .import NXP_VID, LPC5516_PID

# Import drivers.
from serial import *
from .SupernovaSDK.BinhoSupernova.Supernova import Supernova

# Import USB HID commands library.
from .SupernovaSDK.BinhoSupernova.commands.definitions import *
from .SupernovaSDK.BinhoSupernova.commands.validators import *

# Import other modules
from .SupernovaSDK.BinhoSupernova.utils.system_message import *

class Pulsar():
    """
    This class represents the Binho Pulsar device.

    It involves the drivers used to communicate with the device (USB HID and Serial Port),
    and the different processes that control the commands request and responses.
    """

    def __init__(self):
        """
        Constructor defined to add the Pulsar attributes and initialize them as None.
        """
        self.__driver = Supernova() # We utilize the supernova class as low level driver, since its API and pulsars is very similar

    # This function tries to hotfix a hardcoded string used in a wrapper in the Supernova class.
    def __error_message_parser_wrapper(func):
        def __check_error_message(self, *args, **kwargs):
            result = func(self, *args, **kwargs)
            if result["opcode"] == SystemOpcode.CONFIGURATION_ERROR.value:
                result["message"] = "Pulsar not configured appropriately, please check if connection is open and callback is set"
            return result
        return __check_error_message

    # Public methods ----------------------------------------------------------------------------------

    def open(self, vid: int = NXP_VID, pid: int = LPC5516_PID, serial: int = None, path: str = None) -> dict:
        """
        This method establishes the USB communication with the Pulsar. When this method is invoked, the USB Host starts to send USB frames to the
        USB device, and to poll the Input endpoint.

        It is possible to connect to the USB device only with the VID and PID. Optionally, the serial number can be passed as argument.

        On the contrary, the path string can be used to identify every the device, so passing the path only is enough to connect with
        the desired device. To get the device path, the BinhoPulsar.getConnectedPulsarDevicesList() method can be invoked.

        Parameters
        ----------
        vid : int
            USB device VID number. By default the NXP VID number is used.

        pid : int
            USB device PID number. By default the Binho Pulsar PID number is used.

        serial : int
            USB device serial number. By default is None.

        path : str
            String path generated by the OS that can be read using the BinhoPulsar.getConnectedPulsarDevicesList() method.

        Returns
        -------
        dict
            The SystemMessage in dictionary format.

        """

        result = self.__driver.open(vid=vid, pid=pid, serial=serial, path=path)

        if result["opcode"] == SystemOpcode.OK.value:
            result["message"] = "Connection with Pulsar device opened successfully."

        return result

    def close(self) -> dict:
        """
        This method closes the communication with the Pulsar and releases the used memory.
        
        Returns
        -------
        dict
            The SystemMessage in dictionary format.

        """

        result = self.__driver.close()

        if result["opcode"] == SystemOpcode.OPEN_CONNECTION_REQUIRED.value:
            result["message"] = "It is required to open connection with a Pulsar first. Invoke open() method."
        
        return result

    def onEvent(self, callback_func) -> dict:
        """
        This method registers the callback invoked every time a new USB response or notification
        arrives from the USB device. The callback function must implement the following signature:

            def callback(pulsar_response, system_message) -> None:

        It's important to note that the callback is called directly. If the callback function
        introduces a delay, it can impact the receiving mechanism. Developers using this SDK are
        advised to implement a queuing mechanism to quickly liberate the SDK as soon as the callback
        is called. This approach helps in managing responses efficiently without blocking the SDK's
        processing capabilities.

        Parameters
        ----------
        callback_func : function
            Callback function that will be invoked every time a new USB response or notification is
            sent by the USB device.

        Returns
        -------
        dict
            The SystemMessage in dictionary format.

        """

        def wrapped_callback_func(msg, sys):  
            if sys and sys.opcode == SystemOpcode.UNEXPECTED_DISCONNECTION:  
                sys.message =  f"Error {SystemOpcode.UNEXPECTED_DISCONNECTION.name}: Unexpected Pulsar disconnection."  
            callback_func(msg, sys)  

        # this is to ensure the core callback is appropiate before setting.
        result = self.__driver.onEvent(callback_func=callback_func)  

        if result["opcode"] == SystemOpcode.INVALID_CALLBACK_SIGNATURE.value:  
            result["message"] = "The function must accept 2 arguments: callback(pulsar_response, system_message)."  
            return result  

        # if core callback did not error, we can set the wrapper over it
        result = self.__driver.onEvent(callback_func=wrapped_callback_func)  
        
        return result

    # -----------------------------------------------------------------------------------
    # Communication API - USB commands
    # -----------------------------------------------------------------------------------

    # Get USB strings -------------------------------------------------------------------
    
    @__error_message_parser_wrapper
    def getUsbString(self, id: int, subCommand : GetUsbStringSubCommand) -> dict:

        """
        This function sends a Get USB String command taking the subcommand
        passed as parameter. The list of subcommands:

        GetUsbStringSubCommand.MANUFACTURER - Returns the manufacturer string ("Binho").
        GetUsbStringSubCommand.PRODUCT_NAME - Returns the product name string ("Binho Pulsar").
        GetUsbStringSubCommand.SERIAL_NUMBER - Returns the product serial number. Up to 32 characters.
        GetUsbStringSubCommand.FW_VERSION - Returns the product firmware version (VX.X.X).
        GetUsbStringSubCommand.HW_VERSION - Returns the product hardware version (HW-X).
        GetUsbStringSubCommand.BT_VERSION - Returns the product bootloader version (VX.X.X).

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represent the transfer id. The range allowed is [1, 65535].

        subCommand : GetUsbStringSubCommand
            Subcommand that indicates what string must be retrieved.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        
        return self.__driver.getUsbString(id=id, subCommand=subCommand)

    @__error_message_parser_wrapper
    def resetDevice(self, id: int) -> dict:
        """
        This function sends a RESET DEVICE command.

        Parameters
        ----------
        id : c_uint16
            A 2-byte unsigned integer representing the transfer ID. The range allowed is [1, 65535].

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.  
        """
        return self.__driver.resetDevice(id=id)

    @__error_message_parser_wrapper
    def enterBootMode(self, id: int) -> dict:
        """
        This function sends a ENTER BOOT MODE command.

        Parameters
        ----------
        id : c_uint16
            A 2-byte unsigned integer representing the transfer ID. The range allowed is [1, 65535].

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.  
        """
        
        return self.__driver.enterBootMode(id=id)

    # Set I2C SPI UART Bus Voltage strings -------------------------------------------------------------------

    @__error_message_parser_wrapper
    def setI2cSpiUartBusVoltage(self, id: int, i2cSpiUartBusVolt : c_uint16) -> dict:
        """
        This method sends a SET_I2C_SPI_UART_BUS_VOLTAGE command taking desired bus voltage

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represent the transfer id. The allowed range is [1, 65535].

        i2cSpiUartBusVolt : c_uint16
            It is a 2-bytes integer that indicates the I2C, SPI and UART bus operating voltage, The allowed range is [1200, 3300] mV.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        
        return self.__driver.setI2cSpiUartBusVoltage(id=id, i2cSpiUartBusVolt=i2cSpiUartBusVolt)

    @__error_message_parser_wrapper
    def getAnalogMeasurements(self, id: int) -> dict:
        """
        This method sends a GET_ANALOG_MEASUREMENTS command and retrieves the analog measures in mV.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represent the transfer id. The allowed range is [1, 65535].

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        
        return self.__driver.getAnalogMeasurements(id=id)

    @__error_message_parser_wrapper    
    def useExternalSourceForI2cSpiUartBusVoltage(self, id: int) -> dict:
        """
        This method sends a USE_EXT_SRC_I2C_SPI_UART_BUS_VOLTAGE command, sets the bus voltage to a measured value and
        retrieves the analog signal measure in mV.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represent the transfer id. The allowed range is [1, 65535].

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        
        return self.__driver.useExternalSourceForI2cSpiUartBusVoltage(id=id)

    @__error_message_parser_wrapper
    def useExternalSourceForI3cBusVoltage(self, id: int) -> dict:
        """
        This method sends a USE_EXT_SRC_I3C_BUS_VOLTAGE command, sets the bus voltage to a measured value and
        retrieves the analog signal measure in mV.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represent the transfer id. The allowed range is [1, 65535].

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        
        return self.__driver.useExternalSourceForI2cSpiUartBusVoltage(id=id)

    # I2C management --------------------------------------------------------------------

    @__error_message_parser_wrapper
    def i2cSetParameters(self, id: int, cancelTransfer = 0x00, baudrate = 0x00) -> dict:
        """
        This method sets the I2C transfers baudrate and allows to cancel a current transfer too.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represent the transfer id. The range allowed is [1, 65535].

        cancelTransfer : byte
            It is a subcommand that allows to cancel the last I2C transfer if it is still running. This
            parameter has to possible values:

            - 0x00: Don't cancel current transfer.
            - 0x01: Cancel current transfer.

        baudrate : int
            This parameter represents the I2C SCL frequency in Hz. Currently, the maximum allowed value is
            1000000 that corresponds to 1 MHz.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        
        return self.__driver.i2cSetParameters(id=id, cancelTransfer=cancelTransfer, baudrate=baudrate)

    @__error_message_parser_wrapper
    def i2cSetPullUpResistors(self, id: int, pullUpResistorsValue: I2cPullUpResistorsValue) -> dict:
        """
        This method sets the I2C pull up resistors for the SDA and SCL lines.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represent the transfer id. The range allowed is [1, 65535].

        pullUpResistorsValue : I2cPullUpResistorsValue Enum
            This parameter represents the different values for the pull up resistors.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        
        return self.__driver.i2cSetPullUpResistors(id=id, pullUpResistorsValue=pullUpResistorsValue)

    @__error_message_parser_wrapper
    def i2cWrite(self, id: int, slaveAddress : int, registerAddress: list, data: list) -> dict:
        """
        This method is used to request to the Pulsar device to perform an I2C write transfer. The
        I2C write transfer starts with a START condition and ends with a STOP condition.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represent the transfer id. The allowed range is [1, 65535].

        slaveAddress : byte
            I2C slave static address.

        registerAddress : list
            Python list that contains the memory/register address of the I2C slave internal memory, whose data
            will be written. The list holds bytes, and can hand hold from 0 bytes up to 4 bytes. 0 bytes means
            that the list can be left empty and the Pulsar will ignore it and write only the data payload.

        data : list
            Python list that contains the I2C data transferred in the I2C Write transfer. The list holds
            bytes elements, and the maximum length is 1024 bytes.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        
        return self.__driver.i2cWrite(id=id, slaveAddress=slaveAddress, registerAddress=registerAddress, data=data)

    @__error_message_parser_wrapper
    def i2cWriteNonStop(self, id: int, slaveAddress : int, registerAddress: list, data: list) -> dict:
        """
        This method is used to request to the USB device to perform an I2C write transfer that
        starts with a START condition but the STOP condition is not performed after the last byte.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represent the transfer id. The allowed range is [1, 65535].

        slaveAddress : byte
            I2C slave static address.

        registerAddress : list
            Python list that contains the memory/register address of the I2C slave internal memory, whose data
            will be written. The list holds bytes, and can hand hold from 0 bytes up to 4 bytes. 0 bytes means
            that the list can be left empty and the Pulsar will ignore it and write only the data payload.

        data : list
            Python list that contains the I2C data transferred in the I2C Write transfer. The list holds
            bytes elements, and the maximum length is 1024 bytes.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        
        return self.__driver.i2cWriteNonStop(id=id, slaveAddress=slaveAddress, registerAddress=registerAddress, data=data)

    @__error_message_parser_wrapper
    def i2cRead(self, id: int, slaveAddress: int, requestDataLength: int) -> dict:
        """
        This method is used to request to the USB device to perform an I2C read transfer. The
        I2C read transfer starts with a START condition and ends with a STOP condition.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represent the transfer id. The allowed range is [1, 65535].

        slaveAddress : byte
            I2C slave static address.

        requestDataLength : int
            Length of the read data. The maximum value is 1024 bytes.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """

        return self.__driver.i2cRead(id=id, slaveAddress=slaveAddress, requestDataLength=requestDataLength)

    @__error_message_parser_wrapper
    def i2cReadFrom(self, id: int, slaveAddress: int, registerAddress: list, requestDataLength: int) -> dict:
        """
        This method is used to request to the the USB device to perform an I2C read transfer, performing
        before an I2C write transfer to send the register/memory address the data will be read from. A R-Start condition
        is performed between the I2C write and I2C read transfers.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represent the transfer id. The allowed range is [1, 65535].

        slaveAddress : byte
            I2C slave static address.

        registerAddress : list
            Python list that contains the memory/register address of the I2C slave internal memory, whose data
            will be read. The list holds bytes, and can hand hold from 0 bytes up to 4 bytes. 0 bytes means
            that the list can be left empty, the Pulsar will ignore it and will perform only a read transfer.

        requestDataLength : int
            Length of the read data. The maximum value is 1024 bytes.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """

        return self.__driver.i2cReadFrom(id=id, slaveAddress=slaveAddress, registerAddress=registerAddress, requestDataLength=requestDataLength)

    # --------------------------UART management --------------------------------------------------------------------

    # ------------------------------UART INIT ----------------------------#

    @__error_message_parser_wrapper
    def uartControllerInit(self, id: int, baudrate: UartControllerBaudRate, hardwareHandshake:bool, parityMode:UartControllerParity, dataSize:UartControllerDataSize, stopBit: UartControllerStopBit ) -> dict:
        """
        This method initializes the UART peripherals

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represents the transfer id. The range allowed is [1, 65535].

        baudrate : UartControllerBaudRate
            This parameter represents the UART TX and RX frequency from the options provided by the UartControllerBaudRate enum.
            The frequency goes from 600bps to up to 115200bps.

        hardwareHandshake : bool 
            This parameter represents a boolean flag to enable or disable this option.
        
        parityMode: UartControllerParity
            This parameter represents the different parity modes available in the UartControllerParity enum.
            The parity modes are: none, even or odd.
        
        dataSize: UartControllerDataSize
            This parameter represents the different data sizes available in the UartControllerDataSize enum.
            The data sizes are either 7 or 8.

        stopBit: UartControllerStopBit
            This parameter represent the different stop bit configuration available in the UartControllerStopBit enum.
            The stop bit can be of size 1 or 2.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """

        return self.__driver.uartControllerInit(id=id, baudrate=baudrate, hardwareHandshake=hardwareHandshake, parityMode=parityMode, dataSize=dataSize, stopBit=stopBit)
    # ------------------------------UART SET ----------------------------#

    @__error_message_parser_wrapper
    def uartControllerSetParameters(self, id: int, baudrate: UartControllerBaudRate, hardwareHandshake:bool, parityMode:UartControllerParity, dataSize:UartControllerDataSize, stopBit: UartControllerStopBit ) -> dict:
        """
        This method sets the UART peripheral parameters

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represent the transfer id. The range allowed is [1, 65535].

        baudrate : UartControllerBaudRate
            This parameter represents the UART TX and RX frequency from the options provided by the UartControllerBaudRate enum.
            The frequency goes from 600bps to up to 115200bps.

        hardwareHandshake : bool 
            This parameter represents a boolean flag to enable or disable this option.

        parityMode: UartControllerParity
            This parameter represents the different parity modes available in the UartControllerParity enum.
            The parity modes are: none, even or odd.
        
        dataSize: UartControllerDataSize
            This parameter represents the different data sizes available in the UartControllerDataSize enum.
            The data sizes are either 7 or 8.

        stopBit: UartControllerStopBit
            This parameter represent the different stop bit configuration available in the UartControllerStopBit enum.
            The stop bit can be of size 1 or 2.


        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """

        return self.__driver.uartControllerSetParameters(id=id, baudrate=baudrate, hardwareHandshake=hardwareHandshake, parityMode=parityMode, dataSize=dataSize, stopBit=stopBit)
    
    # ------------------------------UART SEND ----------------------------#

    @__error_message_parser_wrapper
    def uartControllerSendMessage(self, id: int, data: list) -> dict:
        """
        This method is used to request to the the Pulsar device to perform an UART send transfer.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represent the transfer id. The range allowed is [1, 65535].

        data : list
            Python list that contains the data transferred in the UART Send. The list holds
            bytes elements, and the maximum length is 1024 bytes.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        
        return self.__driver.uartControllerSendMessage(id=id, data=data)
    
    # SPI management --------------------------------------------------------------------

    @__error_message_parser_wrapper               
    def spiControllerInit(self,
                          id: int,
                          bitOrder: SpiControllerBitOrder,
                          mode: SpiControllerMode,
                          dataWidth: SpiControllerDataWidth,
                          chipSelect: SpiControllerChipSelect,
                          chipSelectPol: SpiControllerChipSelectPolarity,
                          frequency: c_uint32) -> dict:
        """
        This method initializes the SPI peripheral with the specified configuration.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represents the transfer id. The range allowed is [1, 65535].

        bitOrder : SpiControllerBitOrder
            Sets the bit order of the SPI peripheral, could be SpiControllerBitOrder.MSB or SpiControllerBitOrder.LSB.
        
        mode : SpiControllerMode
            Sets the SPI mode, could be SpiControllerMode.MODE_0, SpiControllerMode.MODE_1, SpiControllerMode.MODE_2 or SpiControllerMode.MODE_3.
        
        dataWidth : SpiControllerDataWidth
            Sets the SPI data width, could be SpiControllerDataWidth._8_BITS_DATA, SpiControllerDataWidth._16_BITS_DATA.

        chipSelect : SpiControllerChipSelect
            Sets the SPI chip select, could be SpiControllerChipSelect.CHIP_SELECT_0, SpiControllerChipSelect.CHIP_SELECT_1,
            SpiControllerChipSelect.CHIP_SELECT_2 or SpiControllerChipSelect.CHIP_SELECT_3.

        chipSelectPol : SpiControllerChipSelectPolarity
            Sets the SPI chip select polarity, could be SpiControllerChipSelectPolarity.ACTIVE_LOW or SpiControllerChipSelectPolarity.ACTIVE_HIGH.
        
        frequency : c_uint32
            Sets the SPI Clock frequency in Hz. Currently, the minimum allowed value is 10000 Hz and the maximum allowed value is 50000000 Hz.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        return self.__driver.spiControllerInit(id=id, bitOrder=bitOrder, mode=mode, dataWidth=dataWidth, chipSelect=chipSelect, chipSelectPol=chipSelectPol, frequency=frequency)

    @__error_message_parser_wrapper
    def spiControllerSetParameters(self,
                                   id: int,
                                   bitOrder: SpiControllerBitOrder,
                                   mode: SpiControllerMode,
                                   dataWidth: SpiControllerDataWidth,
                                   chipSelect: SpiControllerChipSelect,
                                   chipSelectPol: SpiControllerChipSelectPolarity,
                                   frequency: c_uint32) -> dict:
        """
        This method sets the SPI peripheral configuration.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represents the transfer id. The range allowed is [1, 65535].

        bitOrder : SpiControllerBitOrder
            Sets the bit order of the SPI peripheral, could be SpiControllerBitOrder.MSB or SpiControllerBitOrder.LSB.
        
        mode : SpiControllerMode
            Sets the SPI mode, could be SpiControllerMode.MODE_0, SpiControllerMode.MODE_1, SpiControllerMode.MODE_2 or SpiControllerMode.MODE_3.
        
        dataWidth : SpiControllerDataWidth
            Sets the SPI data width, could be SpiControllerDataWidth._8_BITS_DATA, SpiControllerDataWidth._16_BITS_DATA.

        chipSelect : SpiControllerChipSelect
            Sets the SPI chip select, could be SpiControllerChipSelect.CHIP_SELECT_0, SpiControllerChipSelect.CHIP_SELECT_1,
            SpiControllerChipSelect.CHIP_SELECT_2 or SpiControllerChipSelect.CHIP_SELECT_3.

        chipSelectPol : SpiControllerChipSelectPolarity
            Sets the SPI chip select polarity, could be SpiControllerChipSelectPolarity.ACTIVE_LOW or SpiControllerChipSelectPolarity.ACTIVE_HIGH.
        
        frequency : c_uint32
            Sets the SPI Clock frequency in Hz. Currently, the minimum allowed value is 10000 Hz and the maximum allowed value is 50000000 Hz.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        return self.__driver.spiControllerSetParameters(id=id, bitOrder=bitOrder, mode=mode, dataWidth=dataWidth, chipSelect=chipSelect, chipSelectPol=chipSelectPol, frequency=frequency)

    @__error_message_parser_wrapper
    def spiControllerTransfer(self, id: int, transferLength: int, payload: list) -> dict:
        """
        This method performs a SPI transfer.
        
        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represents the transfer id. The range allowed is [1, 65535].

        transferLength : int
            It is a 2-bytes integer that represents the transfer length. The range allowed is [1, 1024].

        payload : list  
            Python list that contains the SPI data transferred. The list holds bytes elements and
            the maximum length is 1024 bytes.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        return self.__driver.spiControllerTransfer(id=id, transferLength=transferLength, payload=payload)

    # GPIO management --------------------------------------------------------------------

    @__error_message_parser_wrapper
    def gpioConfigurePin(self, id: int, pinNumber: GpioPinNumber, functionality: GpioFunctionality) -> dict:
        """
        This method configures a GPIO pin with the specified functionality.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represents the transfer id. The range allowed is [1, 65535].

        pinNumber : GpioPinNumber
            An enum representing the GPIO pin number to configure.

        functionality : GpioFunctionality
            An enum representing the desired functionality for the GPIO pin.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        return self.__driver.gpioConfigurePin(id=id, pinNumber=pinNumber, functionality=functionality)

    @__error_message_parser_wrapper
    def gpioDigitalWrite(self, id: int, pinNumber: GpioPinNumber, logicLevel: GpioLogicLevel) -> dict:
        """
        This method writes a digital logic level to a GPIO pin.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represents the transfer id. The range allowed is [1, 65535].

        pinNumber : GpioPinNumber
            An enum representing the GPIO pin number to write to.

        logicLevel : GpioLogicLevel
            An enum representing the logic level to write to the GPIO pin.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        return self.__driver.gpioDigitalWrite(id=id, pinNumber=pinNumber, logicLevel=logicLevel)

    @__error_message_parser_wrapper    
    def gpioDigitalRead(self, id: int, pinNumber: GpioPinNumber) -> dict:
        """
        This method reads the digital logic level from a GPIO pin.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represents the transfer id. The range allowed is [1, 65535].

        pinNumber : GpioPinNumber
            An enum representing the GPIO pin number to read from.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        return self.__driver.gpioDigitalRead(id=id, pinNumber=pinNumber)

    @__error_message_parser_wrapper    
    def gpioSetInterrupt(self, id: int, pinNumber: GpioPinNumber, trigger: GpioTriggerType) -> dict:
        """
        This method sets an interruption to a GPIO pin.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represents the transfer id. The range allowed is [1, 65535].

        pinNumber : GpioPinNumber
            An enum representing the GPIO pin number to read from.

        trigger : GpioTriggerType
            The trigger type used for the interruption. Must be one of the options provided by the GpioTriggerType enum.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        return self.__driver.gpioSetInterrupt(id=id, pinNumber=pinNumber, trigger=trigger) 

    @__error_message_parser_wrapper    
    def gpioDisableInterrupt(self, id: int, pinNumber: GpioPinNumber) -> dict:
        """
        This method disables interruptions of a GPIO pin.

        Parameters
        ----------
        id : int
            It is a 2-bytes integer that represents the transfer id. The range allowed is [1, 65535].

        pinNumber : GpioPinNumber
            An enum representing the GPIO pin number to read from.

        Returns
        -------
        dict
            Return the SystemMessage in dictionary format.

        """
        return self.__driver.gpioDisableInterrupt(id=id, pinNumber=pinNumber)